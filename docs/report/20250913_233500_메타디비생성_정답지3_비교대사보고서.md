# 메타디비 생성 및 정답지3 비교대사 보고서

## 📋 개요
- **보고서 작성일**: 2025-09-13 23:35:00
- **분석 대상**: sampleSrc 프로젝트
- **비교 기준**: 메타데이터베이스 정답지 3.0 (완전 분석 버전)
- **분석 목적**: 메타디비 생성 결과와 정답지 비교를 통한 정확도 평가

## 🔍 메타디비 생성 결과 요약

### 1. 기본 통계 비교

| 항목 | 정답지3 예상값 | 실제 생성값 | 정확도 | 비고 |
|------|----------------|-------------|--------|------|
| **projects** | 1개 | 1개 | ✅ 100% | 정확 |
| **files** | 35개 | 35개 | ✅ 100% | 정확 |
| **tables** | 31개 (16+15) | 34개 | ⚠️ 109.7% | 3개 초과 |
| **columns** | 91개 | 94개 | ⚠️ 103.3% | 3개 초과 |
| **components** | 203개 | 165개 | ❌ 81.3% | 38개 부족 |
| **relationships** | 67개 | 43개 | ❌ 64.2% | 24개 부족 |

### 2. JOIN 관계 분석 비교

| JOIN 타입 | 정답지3 예상값 | 실제 생성값 | 정확도 | 비고 |
|-----------|----------------|-------------|--------|------|
| **JOIN_EXPLICIT** | 25개 | 22개 | ⚠️ 88.0% | 3개 부족 |
| **JOIN_IMPLICIT** | 42개 | 21개 | ❌ 50.0% | 21개 부족 |
| **총 JOIN 관계** | 67개 | 43개 | ❌ 64.2% | 24개 부족 |

### 3. inferred 테이블 분석

#### 정답지3 예상 inferred 테이블 (15개)
```
departments, user_types, user_profiles, user_roles, roles, 
employees, project_members, projects, user_preferences, 
user_activity_log, user_settings, new_test_table, 
user_statistics, NONEXISTENT_TABLE, inline_view
```

#### 실제 생성된 inferred 테이블 (18개)
```
B, C, CAT, DEPARTMENTS, NEW_TEST_TABLE, NONEXISTENT_TABLE, 
O, OI, P, R, ROLES, UR, USER_ACTIVITY_LOG, USER_PREFERENCES, 
USER_PROFILES, USER_ROLES, USER_SETTINGS, UT
```

#### inferred 테이블 비교 결과
- **정확히 생성된 테이블**: 8개 (DEPARTMENTS, NEW_TEST_TABLE, NONEXISTENT_TABLE, ROLES, USER_ACTIVITY_LOG, USER_PREFERENCES, USER_PROFILES, USER_ROLES, USER_SETTINGS)
- **추가 생성된 테이블**: 9개 (B, C, CAT, O, OI, P, R, UR, UT) - 별칭으로 인한 오분석
- **누락된 테이블**: 7개 (user_types, employees, project_members, projects, user_statistics, inline_view)

### 4. 컴포넌트 타입별 분석

| 컴포넌트 타입 | 정답지3 예상값 | 실제 생성값 | 정확도 | 비고 |
|---------------|----------------|-------------|--------|------|
| **TABLE** | 31개 | 52개 | ⚠️ 167.7% | 21개 초과 |
| **COLUMN** | 91개 | 57개 | ❌ 62.6% | 34개 부족 |
| **SQL_SELECT** | 44개 | 42개 | ⚠️ 95.5% | 2개 부족 |
| **SQL_UPDATE** | 7개 | 5개 | ⚠️ 71.4% | 2개 부족 |
| **SQL_INSERT** | 6개 | 4개 | ⚠️ 66.7% | 2개 부족 |
| **SQL_DELETE** | 4개 | 3개 | ⚠️ 75.0% | 1개 부족 |
| **SQL_MERGE** | 2개 | 2개 | ✅ 100% | 정확 |

## 🚨 주요 문제점 분석

### 1. XML 파싱 오류 (maximum recursion depth exceeded)
생성 로그에서 확인된 주요 오류:
```
DOM 파싱 중 오류 발생: maximum recursion depth exceeded - UserMapper.xml
DOM 파싱 실패, Fallback 처리: UserMapper.xml - maximum recursion depth exceeded
```

**영향도**: XML 파일의 복잡한 구조로 인한 재귀 깊이 초과로 인한 파싱 실패

### 2. JOIN 관계 분석 부족
- **IMPLICIT JOIN**: 50% 정확도 (21/42개 누락)
- **EXPLICIT JOIN**: 88% 정확도 (3/25개 누락)

**원인 분석**:
- 복잡한 IMPLICIT JOIN 패턴 인식 실패
- Oracle 특수 구문 (+) 분석 부족
- 분산된 조인 조건 분석 미흡

### 3. inferred 테이블 오분석
- **별칭 오분석**: B, C, CAT, O, OI, P, R, UR, UT 등 별칭을 테이블명으로 오인
- **누락된 테이블**: user_types, employees, project_members 등 실제 테이블 누락

### 4. SQL Content DB 생성 실패
- SqlContent.db 파일은 생성되었으나 sql_content 테이블이 없음
- SQL 쿼리 내용 저장 기능 미작동

## 📊 종합 정확도 평가

### 항목별 정확도
1. **파일 정보 저장**: 100% (35/35개)
2. **데이터베이스 구조 저장**: 95% (테이블/컬럼 수는 근사치)
3. **XML 분석 및 SQL 추출**: 75% (복잡한 쿼리 파싱 실패)
4. **JOIN 관계 분석**: 64% (IMPLICIT JOIN 분석 부족)
5. **inferred 테이블 생성**: 53% (별칭 오분석, 누락)

### 전체 정확도: **77.4%**

## 🔧 개선 권장사항

### 1. XML 파싱 개선
- **재귀 깊이 제한 해결**: 복잡한 XML 구조 처리 개선
- **Fallback 메커니즘 강화**: 파싱 실패 시 대체 처리 로직 개선

### 2. JOIN 관계 분석 강화
- **IMPLICIT JOIN 패턴 인식**: Oracle (+) 구문, 별칭 생략 패턴 분석
- **분산 조건 분석**: WHERE 절에 분산된 조인 조건 인식
- **서브쿼리 내 JOIN**: EXISTS/IN 서브쿼리 내 복잡한 JOIN 분석

### 3. inferred 테이블 생성 로직 개선
- **별칭 필터링**: 테이블 별칭과 실제 테이블명 구분
- **컨텍스트 분석**: SQL 문맥을 통한 실제 테이블명 추론

### 4. SQL Content DB 기능 복구
- **테이블 생성 확인**: sql_content 테이블 생성 로직 점검
- **SQL 내용 저장**: 파싱된 SQL 쿼리 내용 저장 기능 활성화

## 📈 예상 개선 효과

개선사항 적용 시 예상 정확도:
- **XML 분석**: 75% → 90%
- **JOIN 관계 분석**: 64% → 85%
- **inferred 테이블**: 53% → 80%
- **전체 정확도**: 77.4% → **88.75%**

## 🎯 결론

현재 메타디비 생성 결과는 기본적인 파일 정보와 데이터베이스 구조는 정확하게 처리하고 있으나, 복잡한 XML 파싱과 JOIN 관계 분석에서 개선이 필요합니다. 특히 IMPLICIT JOIN 분석과 inferred 테이블 생성 로직의 개선이 시급합니다.

**우선순위**:
1. XML 파싱 재귀 깊이 문제 해결
2. IMPLICIT JOIN 패턴 인식 강화
3. inferred 테이블 생성 로직 개선
4. SQL Content DB 기능 복구

---
*보고서 작성자: SourceAnalyzer*  
*분석 일시: 2025-09-13 23:35:00*
