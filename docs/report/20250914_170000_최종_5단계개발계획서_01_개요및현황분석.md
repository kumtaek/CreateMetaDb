# 20250914_170000_최종_5단계개발계획서_01_개요및현황분석

## 1. 문서 목적

이 문서는 SourceAnalyzer 시스템의 **5단계 개발 계획에 대한 최종 통합 문서**입니다. 기존에 논의된 모든 `5단계개발계획서*.md` 관련 파일들과 `docs/*.md` 문서들을 종합하여, 개발자가 시스템을 이해하고 개발하는 데 필요한 모든 정보를 상세하게 제공합니다.

**대상 독자**: 개발자, 시스템 아키텍트, PM
**참조 문서**: [요구사항정의서.md](./요구사항정의서.md), [메타데이터베이스스키마정의서.md](./메타데이터베이스스키마정의서.md), [처리플로우_요약.md](./처리플로우_요약.md)

## 2. 시스템 개요

SourceAnalyzer 시스템은 동적 프로젝트 분석을 목표로 하며, 하드코딩된 경로와 프로젝트명을 제거하고 명령행 파라미터로 프로젝트를 지정할 수 있도록 개선되었습니다. 프로젝트의 소스코드, DB 스키마 정보 등을 분석하여 메타데이터베이스에 저장하고, 이를 기반으로 다양한 리포트를 생성합니다.

### 2.1. 핵심 요구사항

*   **동적 프로젝트 처리**: `--project-name {project_name}` 파라미터를 통해 프로젝트를 동적으로 지정하고, 해당 프로젝트의 `src/` 및 `db_schema/` 폴더에서 소스 및 DB 스키마 정보를 수집합니다.
*   **메타데이터 저장 전략**:
    *   **메타DB에 저장**: 테이블명, 컬럼명, 관계, JOIN 정보 등 구조적 정보만 저장합니다.
    *   **SQL Content DB에 저장**: 정제된 SQL 내용을 gzip 압축하여 별도 데이터베이스에 저장합니다 (현재 보류 상태).
    *   **파일에서 동적 로드**: 소스코드 내용은 스토리지 효율을 위해 메타DB에 저장하지 않고, 필요시에만 파일에서 동적으로 로드합니다.
    *   **중복 제거**: 모든 메타정보는 중복 없이 생성 및 저장됩니다.
*   **분석 프로세스**:
    1.  **CSV 로드**: `db_schema/*.csv`에서 테이블/컬럼 정보를 로드합니다.
    2.  **소스 분석**: `src/` 하위 Java, MyBatis XML, JSP 파일을 분석합니다.
    3.  **JOIN 추출**: 쿼리에서 JOIN 관계를 도출하고, 미존재 테이블 발견 시 등록합니다.
    4.  **메타DB 저장**: 중복 없는 구조적 정보만 저장합니다.
    5.  **리포트 생성**: `report/` 폴더에 리포트를 출력합니다.

### 2.2. 시스템 폴더 구조

```
D:\Analyzer\CreateMetaDb\
├── config/                  # 설정 파일들
│   ├── config.yaml         # 시스템 설정
│   ├── logging.yaml        # 로깅 설정
│   ├── target_source_config.yaml # 대상 소스 설정
│   └── parser/             # 파서별 키워드 설정
│       ├── mybatis_dom_rules.yaml  # MyBatis DOM 파싱 규칙
│       ├── mybatis_keyword.yaml    # MyBatis 키워드 설정
│       ├── method_xml_patterns.yaml # 메서드 XML 패턴 정의
│       ├── java_keyword.yaml       # Java 키워드 설정
│       ├── jsp_keyword.yaml        # JSP 키워드 설정
│       └── sql_keyword.yaml        # SQL 키워드 설정
├── database/               # DB 스키마
│   ├── create_table_script.sql  # 메타데이터베이스 스키마
│   └── create_sql_content_db.sql  # SQL Content DB 스키마
├── docs/                   # 문서들
│   ├── report/             # 진척보고 및 분석 리포트
│   ├── 메타데이터베이스스키마정의서.md
│   ├── 요구사항정의서.md
│   ├── 처리플로우_요약.md
│   ├── 처리플로우_상세_1단계.md
│   ├── 처리플로우_상세_2단계.md
│   ├── 처리플로우_상세_3단계.md
│   ├── 처리플로우_상세_4단계.md
│   └── 처리플로우_상세_5단계.md
├── parser/                 # 파서 소스 코드
│   ├── xml_parser.py       # MyBatis XML 파서 (DOM + SAX Fallback)
│   ├── java_parser.py      # Java 파서
│   ├── jsp_parser.py       # JSP 파서 (개발 예정)
│   ├── sax_fallback_parser.py # SAX Fallback 파서
│   └── manual/             # 파서 개발 가이드
├── util/                   # 유틸리티 소스 코드
│   ├── arg_utils.py        # 명령행 인자 처리
│   ├── config_utils.py     # 설정 파일 처리
│   ├── database_utils.py   # 데이터베이스 유틸리티
│   ├── file_utils.py       # 파일 처리 유틸리티
│   ├── global_project.py   # 전역 프로젝트 정보 관리
│   ├── hash_utils.py       # 해시 처리 유틸리티
│   ├── logger.py           # 로깅 유틸리티
│   ├── path_utils.py       # 경로 처리 유틸리티
│   ├── sql_content_manager.py  # SQL Content DB 관리
│   └── validation_utils.py # 검증 유틸리티
├── projects/               # 분석 대상 프로젝트들
│   └── sampleSrc/          # 샘플 프로젝트
│       ├── config/
│       │   └── target_source_config.yaml
│       ├── db_schema/      # DB 스키마 CSV 파일
│       │   ├── ALL_TABLES.csv
│       │   └── ALL_TAB_COLUMNS.csv
│       ├── metadata.db     # 메타데이터베이스
│       ├── SqlContent.db   # SQL Content 데이터베이스
│       └── src/            # 소스 코드
├── logs/                   # 로그 파일들
├── temp/                   # 임시 파일들
├── qna/                    # Q&A 폴더
├── main.py                 # 메인 실행 파일
├── file_loading.py         # 1-2단계 처리 (파일 스캔, DB 구조 저장)
├── xml_loading.py          # 3단계 처리 (XML 분석)
├── java_loading.py         # 4단계 처리 (Java 분석)
└── jsp_loading.py          # 5단계 처리 (JSP 분석)
```

## 3. 현재 구현 현황

SourceAnalyzer 시스템은 현재 5단계까지의 핵심 처리 플로우가 구현 완료되었습니다. 각 단계별 상세 내용은 후속 챕터에서 다룹니다.

*   **1단계: 파일 정보 저장 (프로젝트 전체 스캔)**: ✅ **구현 완료**
    *   프로젝트 전체 파일 스캔 및 `files` 테이블에 등록
*   **2단계: 데이터베이스 구조 저장 및 컴포넌트 생성**: ✅ **구현 완료**
    *   CSV 파일에서 테이블/컬럼 정보 추출 및 `tables`, `columns` 테이블에 저장
    *   `components` 테이블에 `TABLE`, `COLUMN` 타입 컴포넌트 등록
*   **3단계: XML 파일 분석 및 SQL 컴포넌트 등록 + JOIN 관계 분석**: ✅ **구현 완료**
    *   MyBatis XML 파일에서 SQL 쿼리 추출 및 `SQL_*` 타입 컴포넌트 등록
    *   JOIN 관계 분석 (Explicit/Implicit) 및 `relationships` 테이블에 등록
    *   DOM 파싱 실패 시 SAX 파서로 Fallback 처리
    *   SQL Content DB에 정제된 SQL 내용 압축 저장 (현재 보류 상태)
*   **4단계: Java 소스코드 분석 및 관계 생성**: ✅ **구현 완료**
    *   Java 파일에서 CLASS, METHOD 추출 및 `classes`, `components` 테이블에 등록
    *   상속, CALL_QUERY, CALL_METHOD, USE_TABLE 관계 분석 및 `relationships` 테이블에 등록
*   **5단계: JSP 파일 분석 및 컴포넌트 등록**: ✅ **구현 완료**
    *   JSP 파일에서 JSP 컴포넌트 추출 및 `components` 테이블에 등록
    *   JSP → Java 메서드 호출 관계 분석 및 `relationships` 테이블에 등록
*   **6단계: 비즈니스 태그 생성**: ⏳ **향후 개발**
    *   컴포넌트에 비즈니스 의미 태그 부여
*   **7단계: 일관성 체크**: ⏳ **향후 개발**
    *   최종 중복 제거, 참조 무결성 점검, 데이터 일관성 검증

---