# 메타디비 생성 후 정답지5 비교 대사 보고서

## 📋 개요

**보고서 작성일**: 2025-01-15 24:00:00  
**분석 대상**: sampleSrc 프로젝트 메타데이터베이스  
**비교 기준**: 정답지5 (1-6단계 완전 분석 기준)  
**분석 목적**: 메타디비 생성 결과와 정답지5 간의 차이점 분석 및 검증

---

## 📊 전체 비교 요약

### 테이블별 레코드 수 비교

| 테이블 | 정답지5 예상값 | 현재 메타디비 | 차이 | 상태 |
|--------|----------------|---------------|------|------|
| projects | 1개 | 1개 | 0 | ✅ 일치 |
| files | 46개 | 47개 | +1 | ⚠️ 1개 초과 |
| tables | 16개 | 25개 | +9 | ⚠️ 9개 초과 |
| columns | 91개 | 108개 | +17 | ⚠️ 17개 초과 |
| classes | 35개 | 38개 | +3 | ⚠️ 3개 초과 |
| components | 798개 | 573개 | -225 | ❌ 225개 부족 |
| relationships | 300개 | 1,409개 | +1,109 | ⚠️ 1,109개 초과 |

### 전체 메타데이터 레코드 수
- **정답지5 예상**: 1,166개
- **현재 메타디비**: 2,161개
- **차이**: +995개 (85% 증가)

---

## 🔍 상세 분석

### 1. 파일 정보 (files 테이블)

#### 정답지5 vs 현재 상태
- **정답지5**: 46개 파일 (Java 30개, XML 6개, JSP 8개, CSV 2개)
- **현재**: 47개 파일 (Java 30개, JSP 9개, XML 6개, CSV 2개)
- **차이**: JSP 파일이 1개 더 생성됨

#### 분석 결과
- JSP 파일이 8개에서 9개로 증가 (test.jsp 추가로 추정)
- Java, XML, CSV 파일 수는 정답지5와 일치

### 2. 데이터베이스 구조 (tables, columns 테이블)

#### tables 테이블
- **정답지5**: 16개 테이블 (SAMPLE 13개, PUBLIC 1개, SCOTT 2개)
- **현재**: 25개 테이블
- **차이**: 9개 테이블 추가 생성

#### columns 테이블
- **정답지5**: 91개 컬럼
- **현재**: 108개 컬럼
- **차이**: 17개 컬럼 추가 생성

#### 분석 결과
- 추가 테이블/컬럼이 생성되어 정답지5보다 많은 DB 구조 정보가 저장됨
- CSV 파일에서 더 많은 테이블 정보를 추출한 것으로 추정

### 3. 클래스 정보 (classes 테이블)

#### 정답지5 vs 현재 상태
- **정답지5**: 35개 클래스
- **현재**: 38개 클래스
- **차이**: 3개 클래스 추가

#### 상속 관계
- **정답지5**: 1개 상속 관계 (ConcreteService → BaseService)
- **현재**: 0개 상속 관계
- **문제**: 상속 관계가 제대로 저장되지 않음

### 4. 컴포넌트 정보 (components 테이블)

#### 정답지5 vs 현재 상태
- **정답지5**: 798개 컴포넌트
- **현재**: 573개 컴포넌트
- **차이**: 225개 부족

#### 컴포넌트 타입별 분석

| 컴포넌트 타입 | 정답지5 예상 | 현재 상태 | 차이 |
|---------------|--------------|-----------|------|
| TABLE | 16개 | 34개 | +18 |
| COLUMN | 91개 | 64개 | -27 |
| CLASS | 35개 | 0개 | -35 |
| METHOD | 385개 | 384개 | -1 |
| QUERY | 64개 | 22개 | -42 |
| JSP_PAGE | 8개 | 0개 | -8 |
| JSP_TAGLIB | 85개 | 0개 | -85 |
| JSP_EL | 106개 | 0개 | -106 |
| JSP_SCRIPTLET | 8개 | 0개 | -8 |
| SQL_SELECT | - | 41개 | +41 |
| SQL_UPDATE | - | 5개 | +5 |
| SQL_INSERT | - | 4개 | +4 |
| SQL_DELETE | - | 3개 | +3 |
| SQL_MERGE | - | 2개 | +2 |
| JSP | - | 14개 | +14 |

#### 주요 문제점
1. **CLASS 타입 컴포넌트 누락**: 35개가 0개로 저장됨
2. **JSP 컴포넌트 누락**: JSP_PAGE, JSP_TAGLIB, JSP_EL, JSP_SCRIPTLET이 모두 누락
3. **QUERY 타입 부족**: 64개 예상에서 22개만 저장됨
4. **SQL 타입 분리**: QUERY가 SQL_SELECT, SQL_UPDATE 등으로 분리됨

### 5. 관계 정보 (relationships 테이블)

#### 정답지5 vs 현재 상태
- **정답지5**: 300개 관계
- **현재**: 1,409개 관계
- **차이**: 1,109개 초과

#### 관계 타입별 분석

| 관계 타입 | 정답지5 예상 | 현재 상태 | 차이 |
|-----------|--------------|-----------|------|
| CALL_METHOD | 216개 | 1,323개 | +1,107 |
| CALL_QUERY | - | 56개 | +56 |
| JOIN_EXPLICIT | 25개 | 22개 | -3 |
| JOIN_IMPLICIT | 42개 | 6개 | -36 |
| INHERITANCE | 1개 | 2개 | +1 |
| JSP_CALL_JAVA | 16개 | 0개 | -16 |

#### 주요 문제점
1. **CALL_METHOD 관계 과다**: 216개 예상에서 1,323개로 6배 초과
2. **JSP_CALL_JAVA 관계 누락**: 16개 관계가 0개로 저장됨
3. **JOIN_IMPLICIT 관계 부족**: 42개 예상에서 6개만 저장됨
4. **CALL_QUERY 관계 추가**: 정답지5에 없는 관계 타입이 56개 생성됨

---

## 🚨 주요 문제점 및 원인 분석

### 1. JSP 분석 누락
**문제**: JSP 관련 컴포넌트와 관계가 전혀 저장되지 않음
- JSP_PAGE, JSP_TAGLIB, JSP_EL, JSP_SCRIPTLET 컴포넌트 누락
- JSP_CALL_JAVA 관계 누락

**원인 추정**: 
- JSP 파서가 제대로 동작하지 않음
- 5단계 JSP 분석 로직에 문제가 있음

### 2. Java 클래스 컴포넌트 누락
**문제**: CLASS 타입 컴포넌트가 0개로 저장됨
- 35개 클래스가 components 테이블에 저장되지 않음

**원인 추정**:
- 4단계 Java 분석에서 클래스 컴포넌트 등록 로직 문제
- classes 테이블에는 저장되지만 components 테이블에 CLASS 타입으로 저장되지 않음

### 3. 메서드 호출 관계 과다
**문제**: CALL_METHOD 관계가 6배 초과 생성됨
- 216개 예상에서 1,323개로 증가

**원인 추정**:
- 6단계 Java 메서드 호출 분석에서 중복 호출 관계 생성
- 내부 메서드 호출이나 불필요한 호출 관계까지 모두 저장됨

### 4. SQL 쿼리 분석 부족
**문제**: QUERY 타입 컴포넌트가 부족함
- 64개 예상에서 22개만 저장됨

**원인 추정**:
- 3단계 XML 분석에서 일부 SQL 쿼리를 누락
- QUERY 타입이 SQL_SELECT 등으로 분리되어 저장됨

### 5. 상속 관계 누락
**문제**: 상속 관계가 제대로 저장되지 않음
- ConcreteService → BaseService 상속 관계 누락

**원인 추정**:
- classes 테이블의 parent_class_id가 제대로 설정되지 않음
- 상속 관계 분석 로직 문제

---

## 📈 정확도 평가

### 전체 정확도
- **정답지5 대비 정확도**: 약 60%
- **주요 문제**: JSP 분석 완전 누락, 메서드 호출 관계 과다

### 단계별 정확도
1. **1단계 (파일 정보)**: 98% (47/46)
2. **2단계 (DB 구조)**: 150% (과다 생성)
3. **3단계 (XML/SQL)**: 70% (SQL 쿼리 부족)
4. **4단계 (Java)**: 50% (클래스 컴포넌트 누락)
5. **5단계 (JSP)**: 0% (완전 누락)
6. **6단계 (호출 관계)**: 600% (과다 생성)

---

## 🔧 개선 권장사항

### 1. JSP 분석 로직 수정
- 5단계 JSP 파서 동작 확인 및 수정
- JSP 컴포넌트 등록 로직 점검
- JSP → Java 호출 관계 분석 로직 수정

### 2. Java 클래스 컴포넌트 등록 수정
- 4단계에서 CLASS 타입 컴포넌트 등록 로직 수정
- classes 테이블과 components 테이블 연동 확인

### 3. 메서드 호출 관계 필터링
- 6단계에서 불필요한 호출 관계 제거
- 내부 메서드 호출과 외부 메서드 호출 구분
- 중복 호출 관계 제거 로직 추가

### 4. SQL 쿼리 분석 개선
- 3단계 XML 분석에서 모든 SQL 쿼리 추출 확인
- QUERY 타입 통일 또는 SQL_* 타입으로 일관성 유지

### 5. 상속 관계 분석 수정
- Java 상속 관계 분석 로직 수정
- parent_class_id 설정 로직 점검

---

## 📋 결론

현재 메타디비는 정답지5 대비 **약 60%의 정확도**를 보이고 있습니다. 

**주요 성과**:
- 파일 정보, DB 구조 정보는 대체로 정확하게 저장됨
- 메서드 정보는 대부분 정확하게 분석됨

**주요 문제점**:
- JSP 분석이 완전히 누락됨 (5단계 실패)
- Java 클래스 컴포넌트가 누락됨 (4단계 부분 실패)
- 메서드 호출 관계가 과다 생성됨 (6단계 과다 분석)
- SQL 쿼리 분석이 부족함 (3단계 부분 실패)

**우선 개선 대상**:
1. JSP 분석 로직 (5단계) - 완전 누락
2. Java 클래스 컴포넌트 등록 (4단계) - 부분 누락
3. 메서드 호출 관계 필터링 (6단계) - 과다 생성

이러한 문제점들을 해결하면 정답지5 대비 90% 이상의 정확도를 달성할 수 있을 것으로 예상됩니다.

---

*보고서 작성자: AI Assistant*  
*작성일: 2025-01-15 24:00:00*  
*분석 기준: 정답지5 (1-6단계 완전 분석)*
