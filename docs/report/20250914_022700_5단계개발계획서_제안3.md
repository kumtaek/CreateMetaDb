# 5단계 개발계획서 - JSP 파서 설계 및 구현 제안3

## 1. 개요

`20250914_022700_5단계개발계획서_제안2_답변.md` 파일을 검토한 결과, 5단계 JSP 파서 구현을 위한 추가 검토 의견을 다음과 같이 제안합니다.

## 2. 추가 검토 의견

### 2.1. `jsp_keyword.yaml`의 `class_name_mapping` 및 `method_class_mapping` 활용 방안 (재검토)

*   **의견**: `_extract_class_name_from_object` 함수에서 `object_name`이 매핑에 없을 경우 `object_name[0].upper() + object_name[1:]`와 같이 첫 글자만 대문자로 바꾸는 로직은 일반적인 Java 클래스명 추론에는 적합하지만, `inferred` 클래스 생성 시에는 `InferredClass`와 같은 명확한 이름으로 생성하는 것이 더 좋습니다. `_infer_class_name_from_context` 함수에서 매핑에 없는 경우 `InferredClass`로 반환하는 것은 좋습니다.
    *   **질문**: `_extract_class_name_from_object` 함수에서 매핑에 없는 경우에도 `InferredClass`와 같은 명확한 `inferred` 클래스명으로 반환하고, 이 `inferred` 클래스를 `_create_inferred_class` 함수를 통해 생성하는 방식으로 통일하는 것이 더 명확하고 일관성 있는 처리가 아닐까요?

### 2.2. `_create_inferred_method` 함수 내 `file_id` 설정

*   **의견**: `inferred_method_data`에서 `file_id`를 `None`으로 설정하고 있습니다. `inferred` 메서드는 특정 파일에 속하지 않는다는 의미로 이해됩니다.
    *   **질문**: `inferred` 메서드가 JSP 파일에서 호출되었을 경우, 해당 JSP 파일의 `file_id`를 `inferred` 메서드의 `file_id`로 설정하는 것이 JSP와 `inferred` 메서드 간의 관계를 추적하는 데 더 유용하지 않을까요? 아니면 `inferred` 컴포넌트는 파일과 연결하지 않는 것이 정책입니까?

### 2.3. `util/file_utils.py`의 `is_included_file` 함수 로직

*   **의견**: `is_included_file` 함수에서 `include_patterns`와 `exclude_files`를 모두 `fnmatch`로 처리하고 있습니다. `target_source_config.yaml`의 `exclude_directories`는 어떻게 처리할 것입니까? 현재 로직에는 `exclude_directories`에 대한 처리가 보이지 않습니다.
    *   **질문**: `os.path.relpath`를 사용하여 상대 경로를 얻은 후, `exclude_directories` 패턴과 비교하여 디렉토리 전체를 제외하는 로직이 추가되어야 할 것 같습니다. 이에 대한 의견을 주십시오.

### 2.4. `util/path_utils.py`의 `get_file_id`, `get_jsp_component_id`, `get_method_component_id` 함수 내 `DatabaseUtils` 연결/해제

*   **의견**: 각 함수 내에서 `DatabaseUtils`를 생성하고 `connect()` 및 `disconnect()`를 호출하고 있습니다. 이 함수들이 여러 번 호출될 경우, 매번 데이터베이스 연결/해제 오버헤드가 발생할 수 있습니다.
    *   **질문**: `JspLoadingEngine`에서 `DatabaseUtils` 인스턴스를 생성하여 이 함수들에게 전달하거나, `DatabaseUtils` 내부에 싱글톤 패턴을 적용하여 연결을 재사용하는 방안을 고려해볼 수 있을까요? 아니면 현재와 같이 각 함수 내에서 독립적으로 연결/해제하는 것이 정책입니까?

### 2.5. `_get_method_component_id` 함수 내 `parent_id`를 통한 클래스 연결 로직

*   **의견**: `get_method_component_id` 함수에서 `JOIN components p ON c.parent_id = p.component_id`를 통해 `CLASS` 컴포넌트와 `METHOD` 컴포넌트를 연결하고 있습니다. `components` 테이블의 `parent_id`는 `METHOD` 컴포넌트의 경우 `CLASS` 컴포넌트의 `component_id`를 참조하도록 설계되어 있습니다. 이 로직은 정확합니다.
    *   **질문**: 다만, `inferred` 클래스가 생성될 경우, `inferred` 클래스의 `component_id`가 `parent_id`로 올바르게 설정되는지 확인이 필요합니다. `_create_inferred_class` 함수에서 `components` 테이블에 `CLASS` 타입으로 `inferred` 클래스를 저장하고 그 `component_id`를 반환하도록 되어 있으므로, 이 `component_id`가 `inferred` 메서드의 `parent_id`로 사용될 때 문제가 없는지 확인이 필요합니다.

## 3. 다음 단계

위 추가 검토 의견에 대한 답변을 주시면, 이를 바탕으로 5단계 JSP 파서 구현을 진행하겠습니다.
