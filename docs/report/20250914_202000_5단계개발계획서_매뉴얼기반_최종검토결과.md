# 5단계 개발계획서 매뉴얼 기반 최종 검토 결과

## 문서 정보
- **작성일**: 2025-09-14 20:20:00
- **작성자**: AI Assistant
- **문서 유형**: 매뉴얼 기반 최종 검토 보고서
- **검토 대상**: 최종 5단계 개발계획서 vs parser/manual 폴더
- **검토 범위**: JSP 분석 기능, 설정 파일, 메뉴얼 활용 방안
- **핵심 목표**: JSP 파일에서 연관되는 component와의 관계(엣지) 도출

## 개요

`D:\Analyzer\CreateMetaDb\parser\manual` 폴더의 내용을 참고하여 5단계 최종 개발계획서의 개선점을 종합 검토한 결과를 보고합니다. **핵심 목표는 JSP 파일에서 연관되는 component와의 관계(엣지)를 도출하는 것**이며, 이 관계의 양쪽 노드에 해당하는 객체가 무엇인지 도출하는 것이 가장 중요한 목표입니다.

## 매뉴얼 폴더 구조 분석

### 현재 보유 메뉴얼
```
parser/manual/
├── 01_java/                     # Java 관련
│   ├── java-se-language-updates.pdf
│   └── README.md
├── 02_jsp/                      # JSP 관련
│   ├── jakarta-server-pages-spec-3.1.pdf  ✅ **보유**
│   └── README.md
├── 03_web_frontend/             # 웹 프론트엔드 관련
├── 04_mybatis/                  # MyBatis 관련
├── 05_jpa/                      # JPA 관련
├── 06_oracle_sql/               # Oracle SQL 관련
├── 07_spring/                   # Spring 관련
├── 08_xml/                      # XML 관련
└── 99_common/                   # 공통 가이드
    ├── README.md
    ├── 추가_메뉴얼_다운로드_링크.md
    └── 파서별_메뉴얼_매핑_가이드.md  ✅ **중요**
```

## 핵심 목표 관점에서의 검토 결과

### ✅ 잘 반영된 부분

#### 1. JSP 분석 요소 (관계 도출 관점)
- **스크립틀릿, 표현식, EL, JSTL 분석**: 매뉴얼에서 제시한 JSP 분석 요소들이 모두 반영됨
- **Jakarta Server Pages 3.1 스펙 준수**: 최신 JSP 스펙을 기반으로 한 분석 방식 제시
- **Java 메서드 호출 분석**: JSP → METHOD 관계 도출을 위한 핵심 기능 포함

#### 2. 설정 파일 구조
- **jsp_keyword.yaml**: 매뉴얼에서 권장하는 설정 파일 구조와 일치
- **키워드 및 패턴 설정**: JSP 분석에 필요한 기본 패턴들이 포함됨
- **path_utils.get_parser_config_path 방식**: 크로스플랫폼 대응 완료

### ⚠️ 개선이 필요한 부분

#### 1. JSP 분석 요소 누락 (관계 도출 관점)

**문제**: 매뉴얼에서 제시한 JSP 분석 요소 중 관계 도출에 중요한 부분들이 누락됨

**매뉴얼 기준 (02_jsp/README.md)**:
- JSP 디렉티브 분석 (page, include, taglib)
- JSP 액션 태그 처리 (jsp:useBean, jsp:include 등)
- JSP Custom Tag Development

**현재 계획서**:
- 스크립틀릿, 표현식, EL, JSTL만 분석
- JSP 디렉티브, 액션 태그, 커스텀 태그 분석 누락

**관계 도출 관점에서의 중요성**:
- JSP 디렉티브: 다른 JSP 파일과의 include 관계 도출
- JSP 액션 태그: 동적 페이지 전환, 빈 객체 사용 관계 도출
- 커스텀 태그: 사용자 정의 태그와의 관계 도출

#### 2. JSTL 분석 범위 부족 (관계 도출 관점)

**문제**: JSTL 분석이 Core 태그만으로 제한됨

**매뉴얼 기준**:
- JSTL Core, Formatting, SQL, XML, Functions 라이브러리
- 각 라이브러리별 특화 분석 필요

**현재 계획서**:
- Core, Formatting, SQL만 언급
- XML, Functions 라이브러리 누락

**관계 도출 관점에서의 중요성**:
- JSTL XML: XML 데이터와의 관계 도출
- JSTL Functions: 함수 호출 관계 도출

#### 3. 메뉴얼 활용 방안 부재

**문제**: 매뉴얼 참조 및 활용 방안이 계획서에 명시되지 않음

**매뉴얼 기준 (99_common/파서별_메뉴얼_매핑_가이드.md)**:
- 파서 개발 시 메뉴얼 폴더 확인 필수
- 공식 문서 참조 기반 키워드 및 패턴 추출
- 메뉴얼 예제 코드로 테스트

**현재 계획서**:
- 메뉴얼 참조 언급 없음
- 공식 스펙 기반 분석 방안 부재

## 상세 개선 권장사항

### 1. JSP 분석 요소 확장 (관계 도출 중심)

#### 1.1 JSP 디렉티브 분석 추가
```yaml
# jsp_keyword.yaml에 추가
jsp_directive_patterns:
  - r'<%@\s*page\s+([^%]+)%>'  # page 디렉티브
  - r'<%@\s*include\s+([^%]+)%>'  # include 디렉티브
  - r'<%@\s*taglib\s+([^%]+)%>'  # taglib 디렉티브

jsp_directive_analysis:
  page:
    - language: java
    - contentType: text/html
    - pageEncoding: UTF-8
    - import: 패키지 임포트 분석
  include:
    - file: 포함 파일 분석  # JSP → JSP 관계 도출
  taglib:
    - uri: 태그 라이브러리 URI
    - prefix: 태그 접두사
```

**관계 도출 효과**:
- JSP → JSP 관계 (include 디렉티브)
- JSP → 태그 라이브러리 관계 (taglib 디렉티브)

#### 1.2 JSP 액션 태그 분석 추가
```yaml
jsp_action_patterns:
  - r'<jsp:([^>]+)>'  # JSP 액션 태그
  - r'<jsp:include\s+([^>]+)>'  # include 액션
  - r'<jsp:forward\s+([^>]+)>'  # forward 액션
  - r'<jsp:useBean\s+([^>]+)>'  # useBean 액션
  - r'<jsp:setProperty\s+([^>]+)>'  # setProperty 액션
  - r'<jsp:getProperty\s+([^>]+)>'  # getProperty 액션

jsp_action_analysis:
  include:
    - page: 포함할 페이지 분석  # JSP → JSP 관계 도출
    - flush: 버퍼 플러시 여부
  forward:
    - page: 전달할 페이지 분석  # JSP → JSP 관계 도출
  useBean:
    - id: 빈 식별자
    - class: 빈 클래스명  # JSP → Java Bean 관계 도출
    - scope: 빈 스코프
```

**관계 도출 효과**:
- JSP → JSP 관계 (include, forward 액션)
- JSP → Java Bean 관계 (useBean 액션)

#### 1.3 JSTL 라이브러리 확장
```yaml
jsp_jstl_patterns:
  # Core 라이브러리 (기존)
  - r'<c:([^>]+)>'  # JSTL Core
  
  # Formatting 라이브러리 (기존)
  - r'<fmt:([^>]+)>'  # JSTL Formatting
  
  # SQL 라이브러리 (기존)
  - r'<sql:([^>]+)>'  # JSTL SQL
  
  # XML 라이브러리 (추가)
  - r'<x:([^>]+)>'  # JSTL XML
  
  # Functions 라이브러리 (추가)
  - r'\$\{fn:([^}]+)\}'  # JSTL Functions

jstl_library_analysis:
  core:
    - forEach: 반복 처리 분석
    - if: 조건 처리 분석
    - choose: 선택 처리 분석
    - set: 변수 설정 분석
  formatting:
    - formatDate: 날짜 포맷 분석
    - formatNumber: 숫자 포맷 분석
    - parseDate: 날짜 파싱 분석
  sql:
    - query: SQL 쿼리 분석  # JSP → SQL 관계 도출
    - update: SQL 업데이트 분석
    - transaction: 트랜잭션 분석
  xml:
    - parse: XML 파싱 분석  # JSP → XML 관계 도출
    - forEach: XML 반복 분석
    - if: XML 조건 분석
  functions:
    - length: 문자열 길이
    - substring: 문자열 자르기
    - toLowerCase: 소문자 변환
    - toUpperCase: 대문자 변환
```

**관계 도출 효과**:
- JSP → SQL 관계 (JSTL SQL)
- JSP → XML 관계 (JSTL XML)

### 2. 관계 도출 중심 아키텍처 개선

#### 2.1 관계 타입 확장
```python
# relationships 테이블에 추가할 관계 타입
relationship_types = {
    'CALL_METHOD': 'JSP → METHOD 관계',
    'INCLUDE_JSP': 'JSP → JSP 관계 (include)',
    'FORWARD_JSP': 'JSP → JSP 관계 (forward)',
    'USE_BEAN': 'JSP → Java Bean 관계',
    'USE_TAGLIB': 'JSP → 태그 라이브러리 관계',
    'EXECUTE_SQL': 'JSP → SQL 관계',
    'PARSE_XML': 'JSP → XML 관계'
}
```

#### 2.2 관계 도출 로직 개선
```python
def _extract_jsp_relationships(self, jsp_content: str, jsp_component_id: int) -> List[Dict[str, Any]]:
    """
    JSP 파일에서 모든 관계 추출
    
    Args:
        jsp_content: JSP 파일 내용
        jsp_component_id: JSP 컴포넌트 ID
        
    Returns:
        List[Dict]: 추출된 모든 관계 정보
    """
    relationships = []
    
    # 1. Java 메서드 호출 관계
    method_relationships = self._analyze_java_method_calls(jsp_content)
    relationships.extend(method_relationships)
    
    # 2. JSP include 관계
    include_relationships = self._analyze_jsp_includes(jsp_content)
    relationships.extend(include_relationships)
    
    # 3. JSP forward 관계
    forward_relationships = self._analyze_jsp_forwards(jsp_content)
    relationships.extend(forward_relationships)
    
    # 4. Java Bean 사용 관계
    bean_relationships = self._analyze_bean_usage(jsp_content)
    relationships.extend(bean_relationships)
    
    # 5. 태그 라이브러리 사용 관계
    taglib_relationships = self._analyze_taglib_usage(jsp_content)
    relationships.extend(taglib_relationships)
    
    # 6. SQL 실행 관계
    sql_relationships = self._analyze_sql_execution(jsp_content)
    relationships.extend(sql_relationships)
    
    # 7. XML 파싱 관계
    xml_relationships = self._analyze_xml_parsing(jsp_content)
    relationships.extend(xml_relationships)
    
    return relationships
```

### 3. 메뉴얼 활용 방안 추가

#### 3.1 메뉴얼 참조 섹션 추가
```markdown
## 메뉴얼 참조 및 활용

### 공식 문서 참조
- **Jakarta Server Pages 3.1 Specification**: `parser/manual/02_jsp/jakarta-server-pages-spec-3.1.pdf`
- **JSP Tag Library Reference**: JSP 태그 라이브러리 공식 문서
- **JSTL Reference**: JSP Standard Tag Library 공식 문서

### 메뉴얼 기반 개발 프로세스
1. **스펙 문서 확인**: Jakarta Server Pages 3.1 스펙에서 공식 문법 확인
2. **키워드 추출**: 스펙 문서에서 공식 키워드 및 패턴 추출
3. **설정 파일 업데이트**: 추출된 키워드를 `jsp_keyword.yaml`에 반영
4. **테스트 케이스 작성**: 스펙 문서의 예제 코드로 테스트 케이스 작성
5. **엣지 케이스 검증**: 스펙 문서의 엣지 케이스로 파서 검증
```

#### 3.2 메뉴얼 기반 테스트 계획 추가
```markdown
### 메뉴얼 기반 테스트 계획

#### JSP 스펙 준수 테스트
- **기본 JSP 요소**: 스크립틀릿, 표현식, 디렉티브, 액션 태그
- **EL 표현식**: 기본 EL, 함수 호출, 프로퍼티 접근
- **JSTL 태그**: Core, Formatting, SQL, XML, Functions 라이브러리
- **커스텀 태그**: 사용자 정의 태그 라이브러리

#### 관계 도출 테스트
- **JSP → METHOD 관계**: 스크립틀릿, 표현식, EL에서 메서드 호출
- **JSP → JSP 관계**: include, forward 액션 태그
- **JSP → Java Bean 관계**: useBean 액션 태그
- **JSP → 태그 라이브러리 관계**: taglib 디렉티브
- **JSP → SQL 관계**: JSTL SQL 태그
- **JSP → XML 관계**: JSTL XML 태그

#### 엣지 케이스 테스트
- **중첩 태그**: 복잡한 중첩 구조
- **동적 속성**: 런타임에 결정되는 속성값
- **네임스페이스**: 다양한 네임스페이스 사용
- **에러 처리**: 잘못된 JSP 구문 처리
```

### 4. 추가 메뉴얼 다운로드 권장사항

#### 4.1 높은 우선순위 (즉시 다운로드 권장)
1. **JSP Tag Library Reference** - JSP 액션 태그 분석 필수
2. **JSTL Reference** - JSTL 전체 라이브러리 분석 필수
3. **JSP Custom Tag Development Guide** - 커스텀 태그 분석 필수

#### 4.2 중간 우선순위 (단계별 다운로드)
1. **Jakarta Expression Language Specification** - EL 고급 기능
2. **JSP API Documentation** - JSP API 분석
3. **Servlet API Documentation** - JSP-Servlet 연동 분석

## 구현 우선순위

### Phase 1: 기본 JSP 분석 (현재 계획서)
- 스크립틀릿, 표현식, EL, JSTL Core 분석
- 기본 메서드 호출 관계 분석

### Phase 2: JSP 요소 확장 (매뉴얼 기반 개선)
- JSP 디렉티브 분석 추가
- JSP 액션 태그 분석 추가
- JSTL 전체 라이브러리 분석 확장

### Phase 3: 고급 기능 (매뉴얼 기반 고도화)
- 커스텀 태그 분석
- 동적 속성 분석
- 네임스페이스 처리

## 핵심 목표 달성 방안

### 1. 관계(엣지) 도출 전략

#### 1.1 JSP → METHOD 관계
- **스크립틀릿**: `<% object.method() %>`
- **표현식**: `<%= object.method() %>`
- **EL**: `${object.method()}`
- **JSTL**: `<c:out value="${object.method()}"/>`

#### 1.2 JSP → JSP 관계
- **include 디렉티브**: `<%@ include file="header.jsp" %>`
- **include 액션**: `<jsp:include page="footer.jsp"/>`
- **forward 액션**: `<jsp:forward page="error.jsp"/>`

#### 1.3 JSP → Java Bean 관계
- **useBean 액션**: `<jsp:useBean id="user" class="com.example.User"/>`
- **setProperty 액션**: `<jsp:setProperty name="user" property="name"/>`
- **getProperty 액션**: `<jsp:getProperty name="user" property="name"/>`

#### 1.4 JSP → 태그 라이브러리 관계
- **taglib 디렉티브**: `<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>`
- **커스텀 태그**: `<my:customTag attribute="value"/>`

#### 1.5 JSP → SQL 관계
- **JSTL SQL**: `<sql:query var="result" dataSource="${ds}">SELECT * FROM users</sql:query>`

#### 1.6 JSP → XML 관계
- **JSTL XML**: `<x:parse var="doc" xml="${xmlData}"/>`

### 2. 노드 객체 도출 전략

#### 2.1 소스 노드 (JSP)
- **JSP 파일**: `userList.jsp`
- **JSP 컴포넌트**: components 테이블에 `component_type='JSP'`로 저장

#### 2.2 대상 노드 (다양한 타입)
- **METHOD**: Java 메서드 호출
- **JSP**: 다른 JSP 파일
- **Java Bean**: Java 클래스
- **태그 라이브러리**: 태그 라이브러리
- **SQL**: SQL 쿼리
- **XML**: XML 문서

## 결론

현재 5단계 최종 개발계획서는 **기본적인 JSP 분석 기능은 잘 설계**되어 있으나, **매뉴얼에서 제시한 JSP 분석 요소들이 부분적으로 누락**되어 있습니다.

**핵심 목표 관점에서의 주요 개선 필요사항**:
1. JSP 디렉티브, 액션 태그, 커스텀 태그 분석 추가
2. JSTL 라이브러리 확장 (XML, Functions 추가)
3. 메뉴얼 참조 및 활용 방안 명시
4. 관계 도출 중심 아키텍처 개선

**관계 도출 효과**:
- JSP → METHOD 관계 (기존)
- JSP → JSP 관계 (include, forward)
- JSP → Java Bean 관계 (useBean)
- JSP → 태그 라이브러리 관계 (taglib)
- JSP → SQL 관계 (JSTL SQL)
- JSP → XML 관계 (JSTL XML)

이러한 개선을 통해 **Jakarta Server Pages 3.1 스펙을 완전히 준수**하면서 **JSP 파일에서 연관되는 component와의 관계(엣지)를 체계적으로 도출**하는 시스템을 구축할 수 있을 것으로 판단됩니다.

---

**검토 완료**: 2025-09-14 20:20:00  
**검토 결과**: 기본 설계 양호, JSP 분석 요소 확장 필요  
**권장사항**: 매뉴얼 기반 단계별 기능 확장, 관계 도출 중심 아키텍처 개선
