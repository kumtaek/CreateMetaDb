# SourceAnalyzer ë©”íƒ€ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜ì„œ

## ë¬¸ì„œ ëª©ì 

ì´ ë¬¸ì„œëŠ” SourceAnalyzer ì‹œìŠ¤í…œì˜ **ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ êµ¬ì¡°ì™€ ì„¤ê³„ ì˜ë„**ë¥¼ ìƒì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤.  
**ëŒ€ìƒ ë…ì**: ê°œë°œì, DBA, ì‹œìŠ¤í…œ ì•„í‚¤í…íŠ¸  
**ì°¸ì¡° ë¬¸ì„œ**: [ìš”êµ¬ì‚¬í•­ì •ì˜ì„œ.md](./ìš”êµ¬ì‚¬í•­ì •ì˜ì„œ.md), [ì²˜ë¦¬í”Œë¡œìš°.md](./ì²˜ë¦¬í”Œë¡œìš°.md)  
**ê¸°ì¤€ íŒŒì¼**: `database/create_table_script.sql`

## ê°œìš”

SourceAnalyzer ì‹œìŠ¤í…œì˜ ë©”íƒ€ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜ì„œì…ë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” `database/create_table_script.sql`ì„ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìœ¼ë©°, í”„ë¡œì íŠ¸ ë¶„ì„ ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

## ì‹œìŠ¤í…œ í´ë” êµ¬ì¡°

```
D:\Analyzer\CreateMetaDb\
â”œâ”€â”€ config/                  # ì„¤ì • íŒŒì¼ë“¤
â”‚   â”œâ”€â”€ config.yaml         # ì‹œìŠ¤í…œ ì„¤ì •
â”‚   â”œâ”€â”€ logging.yaml        # ë¡œê¹… ì„¤ì •
â”‚   â”œâ”€â”€ target_source_config.yaml  # íŒŒì¼ í•„í„°ë§ ì„¤ì •
â”‚   â””â”€â”€ parser/             # íŒŒì„œë³„ í‚¤ì›Œë“œ ì„¤ì •
â”‚       â”œâ”€â”€ mybatis_dom_rules.yaml  # MyBatis DOM íŒŒì‹± ê·œì¹™
â”‚       â”œâ”€â”€ mybatis_keyword.yaml    # MyBatis í‚¤ì›Œë“œ ì„¤ì •
â”‚       â””â”€â”€ method_xml_patterns.yaml # ë©”ì„œë“œ XML íŒ¨í„´ ì •ì˜
â”œâ”€â”€ database/               # DB ìŠ¤í‚¤ë§ˆ
â”‚   â”œâ”€â”€ create_table_script.sql  # ë©”íƒ€ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ create_sql_content_db.sql  # SQL Content DB ìŠ¤í‚¤ë§ˆ
â”œâ”€â”€ docs/                   # ë¬¸ì„œë“¤
â”‚   â”œâ”€â”€ ìš”êµ¬ì‚¬í•­ì •ì˜ì„œ.md
â”‚   â”œâ”€â”€ ë©”íƒ€ë°ì´í„°ë² ì´ìŠ¤ìŠ¤í‚¤ë§ˆì •ì˜ì„œ.md
â”‚   â”œâ”€â”€ ì²˜ë¦¬í”Œë¡œìš°_ìš”ì•½.md
â”‚   â”œâ”€â”€ ì²˜ë¦¬í”Œë¡œìš°_ìƒì„¸_1ë‹¨ê³„.md
â”‚   â”œâ”€â”€ ì²˜ë¦¬í”Œë¡œìš°_ìƒì„¸_2ë‹¨ê³„.md
â”‚   â”œâ”€â”€ ì²˜ë¦¬í”Œë¡œìš°_ìƒì„¸_3ë‹¨ê³„.md
â”‚   â””â”€â”€ report/             # ì§„ì²™ë³´ê³ ì„œ
â”œâ”€â”€ parser/                 # íŒŒì„œ ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ xml_parser.py       # MyBatis XML íŒŒì„œ âœ… **êµ¬í˜„ ì™„ë£Œ**
â”‚   â”œâ”€â”€ java_parser.py      # Java íŒŒì„œ âœ… **êµ¬í˜„ ì™„ë£Œ**
â”‚   â””â”€â”€ manual/             # íŒŒì„œ ê°œë°œ ê°€ì´ë“œ
â”œâ”€â”€ util/                   # ìœ í‹¸ë¦¬í‹° ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ global_project.py   # ê¸€ë¡œë²Œ í”„ë¡œì íŠ¸ ì •ë³´ ê´€ë¦¬ âœ… **êµ¬í˜„ ì™„ë£Œ**
â”‚   â”œâ”€â”€ sql_content_manager.py  # SQL Content DB ê´€ë¦¬ âœ… **êµ¬í˜„ ì™„ë£Œ** (ë³´ë¥˜ ìƒíƒœ)
â”‚   â”œâ”€â”€ sql_content_processor.py # SQL Content ì²˜ë¦¬ (í˜„ì¬ ë³´ë¥˜ ìƒíƒœ)
â”‚   â”œâ”€â”€ path_utils.py       # ê²½ë¡œ ìœ í‹¸ë¦¬í‹° âœ… **êµ¬í˜„ ì™„ë£Œ**
â”‚   â”œâ”€â”€ database_utils.py   # ë°ì´í„°ë² ì´ìŠ¤ ìœ í‹¸ë¦¬í‹° âœ… **êµ¬í˜„ ì™„ë£Œ**
â”‚   â””â”€â”€ logger.py           # ë¡œê¹… ìœ í‹¸ë¦¬í‹° âœ… **êµ¬í˜„ ì™„ë£Œ**
â”œâ”€â”€ projects/               # ë¶„ì„ ëŒ€ìƒ í”„ë¡œì íŠ¸ë“¤
â”‚   â””â”€â”€ sampleSrc/          # ìƒ˜í”Œ í”„ë¡œì íŠ¸
â”‚       â”œâ”€â”€ metadata.db     # ë©”íƒ€ë°ì´í„°ë² ì´ìŠ¤
â”‚       â”œâ”€â”€ SqlContent.db   # SQL Content ë°ì´í„°ë² ì´ìŠ¤ (í˜„ì¬ ë³´ë¥˜ ìƒíƒœ)
â”‚       â”œâ”€â”€ config/         # í”„ë¡œì íŠ¸ë³„ ì„¤ì •
â”‚       â””â”€â”€ db_schema/      # DB ìŠ¤í‚¤ë§ˆ CSV íŒŒì¼ë“¤
â”œâ”€â”€ logs/                   # ë¡œê·¸ íŒŒì¼ë“¤
â”œâ”€â”€ temp/                   # ì„ì‹œ íŒŒì¼ë“¤
â”œâ”€â”€ qna/                    # ì§ˆì˜ì‘ë‹µ ë¬¸ì„œë“¤
â”œâ”€â”€ main.py                 # ë©”ì¸ ì‹¤í–‰ íŒŒì¼
â”œâ”€â”€ file_loading.py         # 1-2ë‹¨ê³„ ì²˜ë¦¬ (íŒŒì¼ ìŠ¤ìº”, DB êµ¬ì¡° ì €ì¥)
â””â”€â”€ xml_loading.py          # 3ë‹¨ê³„ ì²˜ë¦¬ (XML ë¶„ì„)
```

## ìŠ¤í‚¤ë§ˆ ë²„ì „

- **ë²„ì „**: v2.0 (ìµœì í™”ëœ ë©”íƒ€ë°ì´í„° ìŠ¤í‚¤ë§ˆ)
- **ê¸°ì¤€ íŒŒì¼**: `database/create_table_script.sql`
- **ì‹œê°„ëŒ€**: í•œêµ­ ì‹œê°„ëŒ€(KST) ì ìš© (UTC+9)
- **ë™ì  í™œìš©**: ./project í´ë”ì˜ íŒŒì¼ë“¤ì„ ë™ì ìœ¼ë¡œ í™œìš©í•˜ì—¬ ì„±ëŠ¥ ìµœì í™”

# 

## ì—°ê²° ê´€ê³„ ì •ë¦¬

- **components**: ê´€ê³„ì˜ ëŒ€ìƒì´ ë˜ëŠ” ëª¨ë“  ê°ì²´ ì €ì¥ (jsp, method, query, table, column)
- **relationships**: ëª¨ë“  ê´€ê³„ë¥¼ í†µí•© ê´€ë¦¬ (ì»´í¬ë„ŒíŠ¸ ê°„, ì»¬ëŸ¼ ê°„, í…Œì´ë¸” ê°„ ê´€ê³„)
- **classes**: í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë³„ë„ í…Œì´ë¸”ë¡œ ê´€ë¦¬í•˜ì—¬ ì •í™•í•œ ê´€ê³„ ëª¨ë¸ë§ ì§€ì›
- **parent_id**: components í…Œì´ë¸”ì˜ ê³„ì¸µ êµ¬ì¡° ë° ë‹¤ì–‘í•œ í…Œì´ë¸”ê³¼ì˜ ê´€ê³„ í‘œí˜„

## ERD (Entity Relationship Diagram)

```mermaid
erDiagram
    projects {
        int project_id
        string project_name
        string project_path
        string hash_value
        string created_at
        string updated_at
        string del_yn
        int total_files
    }

    files {
        int file_id
        int project_id
        string file_path
        string file_name
        string file_type
        string has_error
        string error_message
        string hash_value
        string created_at
        string updated_at
        string del_yn
        int line_count
    }

    classes {
        int class_id
        int project_id
        int file_id
        string class_name
        int parent_class_id
        int line_start
        int line_end
        string has_error
        string error_message
        string hash_value
        string created_at
        string updated_at
        string del_yn
    }

    components {
        int component_id
        int project_id
        int file_id
        string component_name
        string component_type
        int parent_id
        string layer
        int line_start
        int line_end
        string has_error
        string error_message
        string hash_value
        string created_at
        string updated_at
        string del_yn
    }

    tables {
        int table_id
        int project_id
        int component_id
        string table_name
        string table_owner
        string table_comments
        string has_error
        string error_message
        string hash_value
        string created_at
        string updated_at
        string del_yn
    }

    columns {
        int column_id
        int table_id
        int component_id
        string column_name
        string data_type
        int data_length
        string nullable
        string column_comments
        int position_pk
        string data_default
        string owner
        string has_error
        string error_message
        string hash_value
        string created_at
        string updated_at
        string del_yn
    }

    relationships {
        int relationship_id
        int src_id
        int dst_id
        string rel_type
        float confidence
        string has_error
        string error_message
        string hash_value
        string created_at
        string updated_at
        string del_yn
    }

    api_components {
        int api_component_id
        int project_id
        int component_id
        string api_type
        string name
        string method_name
        string url_pattern
        string http_method
        string tech_stack
        string interface_type
        string metadata
        string file_path
        int line_start
        int line_end
        string has_error
        string error_message
        string hash_value
        string created_at
        string updated_at
        string del_yn
    }

    projects ||--o{ files : "has"
    projects ||--o{ classes : "contains"
    projects ||--o{ components : "contains"
    projects ||--o{ tables : "defines"
    projects ||--o{ api_components : "contains"
    files ||--o{ classes : "contains"
    files ||--o{ components : "contains"
    classes ||--o{ classes : "parent_class_id"
    classes ||--o{ components : "parent_id"
    components ||--o{ tables : "defines"
    components ||--o{ relationships : "src_id"
    components ||--o{ relationships : "dst_id"
    components ||--o{ api_components : "api_component_detail"
    tables ||--o{ columns : "has"
    columns ||--o{ components : "component_id"
```

### API ì»´í¬ë„ŒíŠ¸ í†µí•© ERD ìƒì„¸

#### **1. Components í…Œì´ë¸” êµ¬ì¡°**
```mermaid
graph TB
    A[components í…Œì´ë¸”] --> B[API_ENTRY ì»´í¬ë„ŒíŠ¸]
    A --> C[FRONTEND_API ì»´í¬ë„ŒíŠ¸]
    A --> D[METHOD ì»´í¬ë„ŒíŠ¸]
    A --> E[SQL_* ì»´í¬ë„ŒíŠ¸]
    A --> F[TABLE ì»´í¬ë„ŒíŠ¸]
    
    B --> G[api_components\napi_type='API_ENTRY']
    C --> H[api_components\napi_type='FRONTEND_API']
    
    G --> I["tech_stack='SPRING_BOOT'\ninterface_type='List&lt;User&gt;'\nmetadata='{parameters,annotations}'"]
    H --> J["tech_stack='REACT'\ninterface_type='AXIOS'\nmetadata='{call_config,ui_props}'"]
    
    style G fill:#e1f5fe
    style H fill:#e8f5e8
    style I fill:#fff3e0
    style J fill:#f3e5f5
```

#### **2. Relationships í…Œì´ë¸” êµ¬ì¡°**
```mermaid
graph TB
    K[relationships] --> L[CALL_API_F2B\nFRONTEND_API -> API_ENTRY]
    K --> M[CALL_API_BE\nAPI_ENTRY -> METHOD]
    K --> N[CALL_METHOD_C2S\nMETHOD -> METHOD]
    K --> O[USE_TABLE_S2D\nSQL_* -> TABLE]
    
    style L fill:#e3f2fd
    style M fill:#f3e5f5
    style N fill:#e8f5e8
    style O fill:#fff3e0
```

## í…Œì´ë¸” ìƒì„¸ ì •ì˜

**ì´ í…Œì´ë¸” ìˆ˜**: 8ê°œ (projects, files, classes, components, tables, columns, relationships, api_components)

### 1. projects (í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„°)

í”„ë¡œì íŠ¸ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤.

| ì»¬ëŸ¼ëª…          | ë°ì´í„°íƒ€ì…        | ì œì•½ì¡°ê±´                                  | ì„¤ëª…          |
| ------------ | ------------ | ------------------------------------- | ----------- |
| project_id   | INTEGER      | PRIMARY KEY, AUTOINCREMENT            | í”„ë¡œì íŠ¸ ê³ ìœ  ID  |
| project_name | VARCHAR(100) | NOT NULL                              | í”„ë¡œì íŠ¸ëª…       |
| project_path | VARCHAR(500) | NOT NULL                              | í”„ë¡œì íŠ¸ ê²½ë¡œ     |
| hash_value   | VARCHAR(64)  |                                       | ë³€ê²½ ê°ì§€ìš© í•´ì‹œê°’  |
| created_at   | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìƒì„±ì¼ì‹œ        |
| updated_at   | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìˆ˜ì •ì¼ì‹œ        |
| del_yn       | CHAR(1)      | DEFAULT 'N'                           | ì‚­ì œ ì—¬ë¶€ (Y/N) |
| total_files  | INTEGER      | DEFAULT 0                             | ì „ì²´ íŒŒì¼ ìˆ˜     |

### 2. files (íŒŒì¼ ì¸ë±ìŠ¤)

ë¶„ì„ ëŒ€ìƒ íŒŒì¼ë“¤ì˜ ìµœì†Œ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤.

| ì»¬ëŸ¼ëª…           | ë°ì´í„°íƒ€ì…        | ì œì•½ì¡°ê±´                                  | ì„¤ëª…                          |
| ------------- | ------------ | ------------------------------------- | --------------------------- |
| file_id       | INTEGER      | PRIMARY KEY, AUTOINCREMENT            | íŒŒì¼ ê³ ìœ  ID                    |
| project_id    | INTEGER      | NOT NULL, FK                          | í”„ë¡œì íŠ¸ ID                     |
| file_path     | VARCHAR(500) | NOT NULL                              | ìƒëŒ€ê²½ë¡œ                        |
| file_name     | VARCHAR(200) | NOT NULL                              | íŒŒì¼ëª…                         |
| file_type     | VARCHAR(20)  |                                       | íŒŒì¼ íƒ€ì… (java, jsp, sql, xml) |
| has_error     | CHAR(1)      | DEFAULT 'N'                           | ì˜¤ë¥˜ ì—¬ë¶€ (Y/N)                 |
| error_message | TEXT         |                                       | ì˜¤ë¥˜ ë©”ì‹œì§€                      |
| hash_value    | VARCHAR(64)  | NOT NULL                              | ë³€ê²½ ê°ì§€ìš© í•´ì‹œê°’                  |
| created_at    | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìƒì„±ì¼ì‹œ                        |
| updated_at    | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìˆ˜ì •ì¼ì‹œ                        |
| del_yn        | CHAR(1)      | DEFAULT 'N'                           | ì‚­ì œ ì—¬ë¶€ (Y/N)                 |
| line_count    | INTEGER      |                                       | ë¼ì¸ ìˆ˜                        |

**ì™¸ë˜í‚¤ ê´€ê³„:**

- `project_id` â†’ `projects.project_id`

### 3. classes (í´ë˜ìŠ¤ ì •ë³´)

í´ë˜ìŠ¤ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤.

| ì»¬ëŸ¼ëª…             | ë°ì´í„°íƒ€ì…        | ì œì•½ì¡°ê±´                                  | ì„¤ëª…              |
| --------------- | ------------ | ------------------------------------- | --------------- |
| class_id        | INTEGER      | PRIMARY KEY, AUTOINCREMENT            | í´ë˜ìŠ¤ ê³ ìœ  ID       |
| project_id      | INTEGER      | NOT NULL, FK                          | í”„ë¡œì íŠ¸ ID         |
| file_id         | INTEGER      | NOT NULL, FK                          | íŒŒì¼ ID           |
| class_name      | VARCHAR(200) | NOT NULL                              | í´ë˜ìŠ¤ëª…            |
| parent_class_id | INTEGER      | FK                                    | ìƒì†/êµ¬í˜„ ë¶€ëª¨ í´ë˜ìŠ¤ ID |
| line_start      | INTEGER      |                                       | ì‹œì‘ ë¼ì¸           |
| line_end        | INTEGER      |                                       | ì¢…ë£Œ ë¼ì¸           |
| has_error       | CHAR(1)      | DEFAULT 'N'                           | ì˜¤ë¥˜ ì—¬ë¶€ (Y/N)     |
| error_message   | TEXT         |                                       | ì˜¤ë¥˜ ë©”ì‹œì§€          |
| hash_value      | VARCHAR(64)  |                                       | ë³€ê²½ ê°ì§€ìš© í•´ì‹œê°’      |
| created_at      | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìƒì„±ì¼ì‹œ            |
| updated_at      | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìˆ˜ì •ì¼ì‹œ            |
| del_yn          | CHAR(1)      | DEFAULT 'N'                           | ì‚­ì œ ì—¬ë¶€ (Y/N)     |

**ì™¸ë˜í‚¤ ê´€ê³„:**

- `project_id` â†’ `projects.project_id`
- `file_id` â†’ `files.file_id`
- `parent_class_id` â†’ `classes.class_id` (ìƒì†/êµ¬í˜„ ë¶€ëª¨ í´ë˜ìŠ¤ ì°¸ì¡°)

**ì¸ë±ìŠ¤:**

- `ix_classes_01`: (class_name, file_id, project_id) - UNIQUE
- `ix_classes_02`: (parent_class_id) - ì¼ë°˜ ì¸ë±ìŠ¤

### 4. components (ì½”ë“œ êµ¬ì„± ìš”ì†Œ)

í´ë˜ìŠ¤, ë©”ì„œë“œ ë“±ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í—ˆë¸Œ í…Œì´ë¸”ì…ë‹ˆë‹¤.

| ì»¬ëŸ¼ëª…            | ë°ì´í„°íƒ€ì…        | ì œì•½ì¡°ê±´                                  | ì„¤ëª…                                                                                              |
| -------------- | ------------ | ------------------------------------- | ----------------------------------------------------------------------------------------------- |
| component_id   | INTEGER      | PRIMARY KEY, AUTOINCREMENT            | êµ¬ì„±ìš”ì†Œ ê³ ìœ  ID                                                                                      |
| project_id     | INTEGER      | NOT NULL, FK                          | í”„ë¡œì íŠ¸ ID                                                                                         |
| file_id        | INTEGER      | NOT NULL, FK                          | íŒŒì¼ ID                                                                                           |
| component_name | VARCHAR(200) | NOT NULL                              | êµ¬ì„±ìš”ì†Œëª…                                                                                           |
| component_type | VARCHAR(20)  | NOT NULL                              | êµ¬ì„±ìš”ì†Œ íƒ€ì… (JSP, METHOD, SQL_SELECT, SQL_INSERT, SQL_UPDATE, SQL_DELETE, SQL_MERGE, TABLE, COLUMN, API_ENTRY, FRONTEND_API) |
| parent_id      | INTEGER      |                                       | ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ ID (COLUMNì¼ë•ŒëŠ” TABLEì˜ component_id, METHODì¼ë•ŒëŠ” classesì˜ class_id)                                                                              |
| layer          | VARCHAR(30)  |                                       | ê³„ì¸µ (controller, service, mapper, model, dao, view, jsp, xml, db)                                |
| line_start     | INTEGER      |                                       | ì‹œì‘ ë¼ì¸                                                                                           |
| line_end       | INTEGER      |                                       | ì¢…ë£Œ ë¼ì¸                                                                                           |
| has_error      | CHAR(1)      | DEFAULT 'N'                           | ì˜¤ë¥˜ ì—¬ë¶€ (Y/N)                                                                                     |
| error_message  | TEXT         |                                       | ì˜¤ë¥˜ ë©”ì‹œì§€                                                                                          |
| hash_value     | VARCHAR(64)  |                                       | ë³€ê²½ ê°ì§€ìš© í•´ì‹œê°’                                                                                      |
| created_at     | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìƒì„±ì¼ì‹œ                                                                                            |
| updated_at     | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìˆ˜ì •ì¼ì‹œ                                                                                            |
| del_yn         | CHAR(1)      | DEFAULT 'N'                           | ì‚­ì œ ì—¬ë¶€ (Y/N)                                                                                     |

**ì™¸ë˜í‚¤ ê´€ê³„:**

- `project_id` â†’ `projects.project_id`
- `file_id` â†’ `files.file_id`

**ì¸ë±ìŠ¤:**

- `ix_components_01`: (component_name, file_id, project_id) - UNIQUE

### 4. tables (ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ì •ë³´)

ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤.

| ì»¬ëŸ¼ëª…            | ë°ì´í„°íƒ€ì…        | ì œì•½ì¡°ê±´                                  | ì„¤ëª…          |
| -------------- | ------------ | ------------------------------------- | ----------- |
| table_id       | INTEGER      | PRIMARY KEY, AUTOINCREMENT            | í…Œì´ë¸” ê³ ìœ  ID   |
| project_id     | INTEGER      | NOT NULL, FK                          | í”„ë¡œì íŠ¸ ID     |
| component_id   | INTEGER      | FK                                    | êµ¬ì„±ìš”ì†Œ ID     |
| table_name     | VARCHAR(100) | NOT NULL                              | í…Œì´ë¸”ëª…        |
| table_owner    | VARCHAR(50)  | NOT NULL                              | í…Œì´ë¸” ì†Œìœ ì     |
| table_comments | TEXT         |                                       | í…Œì´ë¸” ì½”ë©˜íŠ¸     |
| has_error      | CHAR(1)      | DEFAULT 'N'                           | ì˜¤ë¥˜ ì—¬ë¶€ (Y/N) |
| error_message  | TEXT         |                                       | ì˜¤ë¥˜ ë©”ì‹œì§€      |
| hash_value     | VARCHAR(64)  |                                       | ë³€ê²½ ê°ì§€ìš© í•´ì‹œê°’  |
| created_at     | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìƒì„±ì¼ì‹œ        |
| updated_at     | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìˆ˜ì •ì¼ì‹œ        |
| del_yn         | CHAR(1)      | DEFAULT 'N'                           | ì‚­ì œ ì—¬ë¶€ (Y/N) |

**ì™¸ë˜í‚¤ ê´€ê³„:**

- `project_id` â†’ `projects.project_id`
- `component_id` â†’ `components.component_id`

**ì¸ë±ìŠ¤:**

- `ix_tables_01`: (table_name, table_owner, project_id) - UNIQUE

### 5. columns (ë°ì´í„°ë² ì´ìŠ¤ ì»¬ëŸ¼ ì •ë³´)

ë°ì´í„°ë² ì´ìŠ¤ ì»¬ëŸ¼ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤.

| ì»¬ëŸ¼ëª…             | ë°ì´í„°íƒ€ì…        | ì œì•½ì¡°ê±´                                  | ì„¤ëª…                   |
| --------------- | ------------ | ------------------------------------- | -------------------- |
| column_id       | INTEGER      | PRIMARY KEY, AUTOINCREMENT            | ì»¬ëŸ¼ ê³ ìœ  ID             |
| table_id        | INTEGER      | NOT NULL, FK                          | í…Œì´ë¸” ID               |
| component_id    | INTEGER      | FK                                    | ì»´í¬ë„ŒíŠ¸ ID (COLUMN íƒ€ì…) |
| column_name     | VARCHAR(100) | NOT NULL                              | ì»¬ëŸ¼ëª…                  |
| data_type       | VARCHAR(50)  |                                       | ë°ì´í„° íƒ€ì…               |
| data_length     | INTEGER      |                                       | ë°ì´í„° ê¸¸ì´               |
| nullable        | CHAR(1)      | DEFAULT 'Y'                           | NULL í—ˆìš© ì—¬ë¶€           |
| column_comments | TEXT         |                                       | ì»¬ëŸ¼ ì½”ë©˜íŠ¸               |
| position_pk     | INTEGER      |                                       | PK ìˆœë²ˆ (nullì´ë©´ PK ì•„ë‹˜) |
| data_default    | TEXT         |                                       | ê¸°ë³¸ê°’                  |
| owner           | VARCHAR(50)  |                                       | ì†Œìœ ì                  |
| has_error       | CHAR(1)      | DEFAULT 'N'                           | ì˜¤ë¥˜ ì—¬ë¶€ (Y/N)          |
| error_message   | TEXT         |                                       | ì˜¤ë¥˜ ë©”ì‹œì§€               |
| hash_value      | VARCHAR(64)  |                                       | ë³€ê²½ ê°ì§€ìš© í•´ì‹œê°’           |
| created_at      | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìƒì„±ì¼ì‹œ                 |
| updated_at      | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìˆ˜ì •ì¼ì‹œ                 |
| del_yn          | CHAR(1)      | DEFAULT 'N'                           | ì‚­ì œ ì—¬ë¶€ (Y/N)          |

**ì™¸ë˜í‚¤ ê´€ê³„:**

- `table_id` â†’ `tables.table_id`
- `component_id` â†’ `components.component_id`

**ì¸ë±ìŠ¤:**

- `ix_columns_01`: (table_id, column_name) - UNIQUE

### 6. relationships (í†µí•© ê´€ê³„ ì •ë³´)

ëª¨ë“  ê´€ê³„ë¥¼ í†µí•© ê´€ë¦¬í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤.

| ì»¬ëŸ¼ëª…             | ë°ì´í„°íƒ€ì…       | ì œì•½ì¡°ê±´                                  | ì„¤ëª…                                                                                            |
| --------------- | ----------- | ------------------------------------- | --------------------------------------------------------------------------------------------- |
| relationship_id | INTEGER     | PRIMARY KEY, AUTOINCREMENT            | ê´€ê³„ ê³ ìœ  ID                                                                                      |
| src_id          | INTEGER     | NOT NULL, FK                          | ì†ŒìŠ¤ ID (component_id, table_id, column_id ë“±)                                                   |
| dst_id          | INTEGER     | NOT NULL, FK                          | ëŒ€ìƒ ID (component_id, table_id, column_id ë“±)                                                   |
| rel_type        | VARCHAR(30) | NOT NULL                              | ê´€ê³„ íƒ€ì… (CALL_API_F2B, CALL_API_BE, CALL_METHOD_C2S, CALL_METHOD_S2D, CALL_QUERY_M2S, CALL_QUERY_D2S, USE_TABLE_Q2D, USE_TABLE_S2D, FK, PK, JOIN_EXPLICIT, JOIN_IMPLICIT, QUERY_TABLE) |
| confidence      | FLOAT       | DEFAULT 1.0                           | ì‹ ë¢°ë„                                                                                           |
| has_error       | CHAR(1)     | DEFAULT 'N'                           | ì˜¤ë¥˜ ì—¬ë¶€ (Y/N)                                                                                   |
| error_message   | TEXT        |                                       | ì˜¤ë¥˜ ë©”ì‹œì§€                                                                                        |
| created_at      | DATETIME    | DEFAULT (datetime('now', '+9 hours')) | ìƒì„±ì¼ì‹œ                                                                                          |
| updated_at      | DATETIME    | DEFAULT (datetime('now', '+9 hours')) | ìˆ˜ì •ì¼ì‹œ                                                                                          |
| del_yn          | CHAR(1)     | DEFAULT 'N'                           | ì‚­ì œ ì—¬ë¶€ (Y/N)                                                                                   |

**ì™¸ë˜í‚¤ ê´€ê³„:**

- `src_id` â†’ `components.component_id` (ëª¨ë“  ê´€ê³„ì˜ ì†ŒìŠ¤)
- `dst_id` â†’ `components.component_id` (ëª¨ë“  ê´€ê³„ì˜ ëŒ€ìƒ)

**ì œì•½ì¡°ê±´:**

- `CHECK (src_id != dst_id)`: ìê¸° ìì‹ ê³¼ì˜ ê´€ê³„ ë°©ì§€

**ì¸ë±ìŠ¤:**

- `ix_relationships_01`: (src_id, dst_id, rel_type) - UNIQUE

### 7. api_components (API ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ì •ë³´)

API_ENTRYì™€ FRONTEND_APIë¥¼ í†µí•©í•œ ìƒì„¸ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤.

| ì»¬ëŸ¼ëª…               | ë°ì´í„°íƒ€ì…        | ì œì•½ì¡°ê±´                                  | ì„¤ëª…                          |
| ----------------- | ------------ | ------------------------------------- | --------------------------- |
| api_component_id  | INTEGER      | PRIMARY KEY, AUTOINCREMENT            | API ì»´í¬ë„ŒíŠ¸ ê³ ìœ  ID             |
| project_id        | INTEGER      | NOT NULL, FK                          | í”„ë¡œì íŠ¸ ID                     |
| component_id      | INTEGER      | NOT NULL, FK                          | components í…Œì´ë¸”ì˜ ì»´í¬ë„ŒíŠ¸ ID     |
| api_type          | VARCHAR(20)  | NOT NULL                              | API íƒ€ì… (API_ENTRY, FRONTEND_API) |
| name              | VARCHAR(200) | NOT NULL                              | ì´ë¦„ (í´ë˜ìŠ¤ëª… ë˜ëŠ” í”„ë¡ íŠ¸ì—”ë“œëª…)      |
| method_name       | VARCHAR(200) |                                       | ë©”ì„œë“œëª… (ê³µí†µ ì‚¬ìš©)              |
| url_pattern       | VARCHAR(500) | NOT NULL                              | URL íŒ¨í„´ (ì˜ˆ: /api/users/{id})     |
| http_method       | VARCHAR(10)  | NOT NULL                              | HTTP ë©”ì„œë“œ (GET, POST, PUT, DELETE ë“±) |
| tech_stack        | VARCHAR(50)  |                                       | ê¸°ìˆ  ìŠ¤íƒ (framework_type + technology_type í†µí•©) |
| interface_type    | VARCHAR(200) |                                       | ì¸í„°í˜ì´ìŠ¤ íƒ€ì… (return_type + call_method í†µí•©) |
| metadata          | TEXT         |                                       | ë©”íƒ€ë°ì´í„° (parameters + annotations í†µí•©, JSON) |
| file_path         | VARCHAR(500) |                                       | íŒŒì¼ ê²½ë¡œ                       |
| line_start        | INTEGER      |                                       | ì‹œì‘ ë¼ì¸                       |
| line_end          | INTEGER      |                                       | ì¢…ë£Œ ë¼ì¸                       |
| has_error         | CHAR(1)      | DEFAULT 'N'                           | ì˜¤ë¥˜ ì—¬ë¶€ (Y/N)                 |
| error_message     | TEXT         |                                       | ì˜¤ë¥˜ ë©”ì‹œì§€                      |
| hash_value        | VARCHAR(64)  | NOT NULL                              | ë³€ê²½ ê°ì§€ìš© í•´ì‹œê°’                  |
| created_at        | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìƒì„±ì¼ì‹œ                        |
| updated_at        | DATETIME     | DEFAULT (datetime('now', '+9 hours')) | ìˆ˜ì •ì¼ì‹œ                        |
| del_yn            | CHAR(1)      | DEFAULT 'N'                           | ì‚­ì œ ì—¬ë¶€ (Y/N)                 |

**ì™¸ë˜í‚¤ ê´€ê³„:**

- `project_id` â†’ `projects.project_id`
- `component_id` â†’ `components.component_id`

**ì¸ë±ìŠ¤:**

- `ix_api_components_01`: (name, method_name, project_id) - UNIQUE
- `ix_api_components_02`: (component_id) - ì¼ë°˜ ì¸ë±ìŠ¤
- `ix_api_components_03`: (api_type) - ì¼ë°˜ ì¸ë±ìŠ¤
- `ix_api_components_04`: (url_pattern) - ì¼ë°˜ ì¸ë±ìŠ¤
- `ix_api_components_05`: (http_method) - ì¼ë°˜ ì¸ë±ìŠ¤
- `ix_api_components_06`: (tech_stack) - ì¼ë°˜ ì¸ë±ìŠ¤

**ë°ì´í„° ì˜ˆì‹œ:**

```sql
-- API_ENTRY ë°ì´í„°
INSERT INTO api_components VALUES (
    101, 1, 1001, 'API_ENTRY', 'UserController', 'getUserList',
    '/api/users/list', 'GET', 'SPRING_BOOT', 'List<User>',
    '{"parameters": [{"name": "id", "type": "Long"}], "annotations": ["@GetMapping", "@RequestMapping"], "framework_config": {"version": "2.7.0"}}',
    '/src/main/java/controller/UserController.java', 25, 35,
    'N', NULL, 'hash_api123', '2024-01-01', '2024-01-01', 'N'
);

-- FRONTEND_API ë°ì´í„°
INSERT INTO api_components VALUES (
    102, 1, 1002, 'FRONTEND_API', 'UserManagementPage', 'fetchUsers',
    '/api/users/list', 'GET', 'REACT', 'AXIOS',
    '{"call_config": {"timeout": 5000, "retry": 3}, "ui_props": {"loading": true, "error_handling": "toast"}}',
    NULL, NULL, NULL,
    'N', NULL, 'hash_frontend123', '2024-01-01', '2024-01-01', 'N'
);
```

## ê´€ê³„ êµ¬ì¡° ì„¤ëª…

### ì»´í¬ë„ŒíŠ¸ ì¤‘ì‹¬ ëª¨ë¸

ì´ ìŠ¤í‚¤ë§ˆëŠ” **components í…Œì´ë¸”ì„ ì¤‘ì‹¬ìœ¼ë¡œ í•œ ê´€ê³„ ëª¨ë¸**ì„ ì±„íƒí•˜ê³  ìˆìŠµë‹ˆë‹¤:

- **components**: ê´€ê³„ì˜ ëŒ€ìƒì´ ë˜ëŠ” ëª¨ë“  ê°ì²´ ì €ì¥ (jsp, method, query, table, column)
- **relationships**: ëª¨ë“  ê´€ê³„ë¥¼ í†µí•© ê´€ë¦¬ (ì»´í¬ë„ŒíŠ¸ ê°„, ì»¬ëŸ¼ ê°„, í…Œì´ë¸” ê°„ ê´€ê³„)
- **tables**: component_idë¥¼ í†µí•´ componentsì™€ ì—°ê²°

### ê´€ê³„ ëª¨ë¸ ë‹¤ì´ì–´ê·¸ë¨

ë‹¤ìŒì€ ì‚¬ìš©ìê°€ ì œì‹œí•œ ê´€ê³„ ëª¨ë¸ì„ ì‹œê°í™”í•œ ë‹¤ì´ì–´ê·¸ë¨ì…ë‹ˆë‹¤:

```
                  [fp]package
                  |
                  [fl]java
                  |
                  [cl]class
                  [cl]class                [f]xml
                  |                        |
  [cp]frontend_api===[cp]api_entry===[cp]method===[cp]query===[cp]table=============
            [cp]method               [cp]table            ||
                  ||                                      ||
                  [cp]query===[cp]table=============[cp]column
                              [cp]table             [cp]column
```

**ê´€ê³„ íƒ€ì… ì„¤ëª…:

* **ë²”ë¡€**: [cp]=component, [cl]=class, [fl]=file, [fp]=files.file_path
- **ì‹±ê¸€ë¼ì¸ (`|`)**: contain ê´€ê³„ (í¬í•¨ ê´€ê³„)
  - `package` contains `java`
  - `java` contains `class`
  - `class` contains `method`
  - `xml` contains `query`
  - `method` contains `query`
- **ë”ë¸”ë¼ì¸ (`===`)**: call/use/associate ê´€ê³„ (í˜¸ì¶œ/ì‚¬ìš© ê´€ê³„)
  - `frontend_api` â†’ `api_entry` (CALL_API_F2B)
  - `api_entry` â†’ `method` (CALL_API_BE)
  - `method` â†’ `method` (CALL_METHOD_C2S, CALL_METHOD_S2D)
  - `method` â†’ `query` (CALL_QUERY_M2S, CALL_QUERY_D2S)
  - `query` â†’ `table` (USE_TABLE_Q2D, USE_TABLE_S2D)
- **ìƒí•˜ ë¶™ì–´ ìˆëŠ” ê²½ìš°**: ê°™ì€ ì¢…ë¥˜ê°„ì˜ ê´€ê³„
  - `method` calls another `method`
  - `table` joins another `table`
  - `class` inherits/implements another `class`

### ì—°ê²° ê´€ê³„ ì •ë¦¬

#### 1. Components í…Œì´ë¸” ì—­í• 

- **ì €ì¥ ëŒ€ìƒ**: ê´€ê³„ì˜ ëŒ€ìƒì´ ë˜ëŠ” ëª¨ë“  ê°ì²´
  - jsp, method, query, table, column, api_entry, frontend_api
- **ì„¤ê³„ ì›ì¹™**: relationships í…Œì´ë¸”ì—ì„œ ê´€ê³„ë¥¼ ì •ì˜í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ê°ì²´

#### 2. Files í…Œì´ë¸” ì—­í• 

* java, xml, csv íŒŒì¼ì„ ë“±ë¡.

* files.file_pathì— íŒ¨í‚¤ì§€ ê²½ë¡œê°€ ì €ì¥ë¨

### 3. Relationships í…Œì´ë¸” ì—­í• 

- **ê´€ê³„ ëŒ€ìƒ**: ëª¨ë“  ê´€ê³„ë¥¼ í†µí•© ê´€ë¦¬ (ì»´í¬ë„ŒíŠ¸ ê°„, ì»¬ëŸ¼ ê°„, í…Œì´ë¸” ê°„ ê´€ê³„)
- **src_id, dst_id**: ëª¨ë‘ components.component_idë¥¼ ì°¸ì¡°
- **ì¡°ì¸ ê´€ê³„**: ì»¬ëŸ¼ ê°„ ì¡°ì¸ ê´€ê³„ë„ relationshipsì—ì„œ ê´€ë¦¬

### ê´€ê³„ íƒ€ì… (rel_type)

relationships í…Œì´ë¸”ì˜ rel_type ì»¬ëŸ¼ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ê°’ë“¤:

#### API ê´€ê³„

- **CALL_API_F2B (FRONTEND_TO_BACKEND)**: í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë°±ì—”ë“œ APIë¡œì˜ í˜¸ì¶œ
  - ì‚¬ìš©: src_id = FRONTEND_API ì»´í¬ë„ŒíŠ¸, dst_id = API_ENTRY ì»´í¬ë„ŒíŠ¸
  - ì˜ˆì‹œ: React ì»´í¬ë„ŒíŠ¸ì—ì„œ Spring Boot API í˜¸ì¶œ

- **CALL_API_BE (BACKEND_ENTRY)**: ë°±ì—”ë“œ API ì§„ì…ì ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œë¡œì˜ í˜¸ì¶œ
  - ì‚¬ìš©: src_id = API_ENTRY ì»´í¬ë„ŒíŠ¸, dst_id = METHOD ì»´í¬ë„ŒíŠ¸
  - ì˜ˆì‹œ: API ì§„ì…ì ì—ì„œ ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œ í˜¸ì¶œ

#### Java ê´€ê³„

- **CALL_METHOD_C2S (CONTROLLER_TO_SERVICE)**: ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì„œë¹„ìŠ¤ë¡œì˜ í˜¸ì¶œ
  - ì‚¬ìš©: src_id = METHOD(controller), dst_id = METHOD(service)

- **CALL_METHOD_S2D (SERVICE_TO_DAO)**: ì„œë¹„ìŠ¤ì—ì„œ DAOë¡œì˜ í˜¸ì¶œ
  - ì‚¬ìš©: src_id = METHOD(service), dst_id = METHOD(dao)

- **CALL_QUERY_M2S (METHOD_TO_SQL)**: ë©”ì„œë“œì—ì„œ SQL ì¿¼ë¦¬ë¡œì˜ í˜¸ì¶œ
  - ì‚¬ìš©: src_id = METHOD, dst_id = SQL_SELECT/SQL_INSERT ë“±

- **CALL_QUERY_D2S (DAO_TO_SQL)**: DAOì—ì„œ SQLë¡œì˜ í˜¸ì¶œ
  - ì‚¬ìš©: src_id = METHOD(dao), dst_id = SQL_SELECT/SQL_INSERT ë“±

#### ë°ì´í„°ë² ì´ìŠ¤ ê´€ê³„

- **USE_TABLE_Q2D (QUERY_TO_DB)**: ì¿¼ë¦¬ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ì‚¬ìš©
  - ì‚¬ìš©: src_id = SQL_*, dst_id = TABLE

- **USE_TABLE_S2D (SQL_TO_DB)**: SQLì—ì„œ í…Œì´ë¸”ë¡œì˜ ì‚¬ìš©
  - ì‚¬ìš©: src_id = SQL_*, dst_id = TABLE

- **FK**: ì™¸ë˜í‚¤ ê´€ê³„
- **PK**: ê¸°ë³¸í‚¤ ê´€ê³„
- **JOIN_EXPLICIT**: ëª…ì‹œì  ì¡°ì¸ ê´€ê³„
- **JOIN_IMPLICIT**: ì•”ì‹œì  ì¡°ì¸ ê´€ê³„
- **QUERY_TABLE**: ì¿¼ë¦¬-í…Œì´ë¸” ê´€ê³„ (ê¸°ì¡´ í˜¸í™˜ì„± ìœ ì§€)

## ì„±ëŠ¥ ìµœì í™” íŠ¹ì§•

1. **ë³€ê²½ ê°ì§€**: ëª¨ë“  í…Œì´ë¸”ì— hash_value ì»¬ëŸ¼ìœ¼ë¡œ ë³€ê²½ ê°ì§€
2. **ì†Œí”„íŠ¸ ì‚­ì œ**: del_yn ì»¬ëŸ¼ìœ¼ë¡œ ë…¼ë¦¬ì  ì‚­ì œ ì§€ì›
3. **ì˜¤ë¥˜ ì¶”ì **: has_error, error_messageë¡œ ì˜¤ë¥˜ ìƒíƒœ ê´€ë¦¬
4. **ì¸ë±ìŠ¤ ìµœì í™”**: ìì£¼ ì¡°íšŒë˜ëŠ” ì»¬ëŸ¼ ì¡°í•©ì— ì¸ë±ìŠ¤ ìƒì„±
5. **ì¤‘ë³µ ë°©ì§€**: UNIQUE ì¸ë±ìŠ¤ë¡œ ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥

## ì‚¬ìš© ê°€ì´ë“œ

### ë°ì´í„° ì‚½ì… ìˆœì„œ

1. projects â†’ files â†’ components
2. tables (components ê¸°ë°˜)
3. columns (tables ê¸°ë°˜)
4. relationships (components ê¸°ë°˜)

### ì¡°íšŒ íŒ¨í„´

- **í”„ë¡œì íŠ¸ë³„ ë¶„ì„**: projects â†’ files â†’ components
- **íŒŒì¼ë³„ ë¶„ì„**: files â†’ components
- **í…Œì´ë¸”ë³„ ë¶„ì„**: tables â†’ columns
- **ì»´í¬ë„ŒíŠ¸ ê´€ê³„ ë¶„ì„**: relationships (src_id, dst_id ëª¨ë‘ components.component_id ì°¸ì¡°)
- **ì»¬ëŸ¼ ê´€ê³„ ë¶„ì„**: relationshipsì—ì„œ ì»¬ëŸ¼ ê°„ ì¡°ì¸ ê´€ê³„ ì§ì ‘ ê´€ë¦¬

## êµ¬í˜„ëœ ê´€ê³„ ëª¨ë¸

### ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­ ë°˜ì˜

ì´ ìŠ¤í‚¤ë§ˆëŠ” ì‚¬ìš©ìê°€ ì œì‹œí•œ ê´€ê³„ ëª¨ë¸ì„ ì™„ì „íˆ ë°˜ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤:

#### 1. ì‹±ê¸€ë¼ì¸ (contain) ê´€ê³„

- **[F] package contains java**: file_pathë¥¼ packageë¡œ í™œìš©
- **[F] java contains class**: Java íŒŒì¼ì´ í´ë˜ìŠ¤ë¥¼ í¬í•¨
- **[C] class contains method**: í´ë˜ìŠ¤ê°€ ë©”ì„œë“œë¥¼ í¬í•¨ (parent_class_id í™œìš©)
- **[F] xml contains query**: XML íŒŒì¼ì´ ì¿¼ë¦¬ë¥¼ í¬í•¨
- **[R] method contains query**: ë©”ì„œë“œê°€ ì¿¼ë¦¬ë¥¼ í¬í•¨

#### 2. ë”ë¸”ë¼ì¸ (call, use) ê´€ê³„

- **[R] frontend_api calls api_entry**: ê°€ìƒ í”„ë¡ íŠ¸ì—”ë“œê°€ API ì§„ì…ì ì„ í˜¸ì¶œ (CALL_API_F2B)
- **[R] api_entry calls method**: API ì§„ì…ì ì´ ë©”ì„œë“œë¥¼ í˜¸ì¶œ (CALL_API_BE)
- **[R] method calls method**: ë©”ì„œë“œê°€ ë©”ì„œë“œë¥¼ í˜¸ì¶œ (CALL_METHOD_C2S, CALL_METHOD_S2D)
- **[R] method calls query**: ë©”ì„œë“œê°€ ì¿¼ë¦¬ë¥¼ í˜¸ì¶œ (CALL_QUERY_M2S, CALL_QUERY_D2S)
- **[R] query uses table**: ì¿¼ë¦¬ê°€ í…Œì´ë¸”ì„ ì‚¬ìš© (USE_TABLE_Q2D, USE_TABLE_S2D)

#### 3. ìƒí•˜ ë¶™ì–´ ìˆëŠ” ê²½ìš° (ê°™ì€ ì¢…ë¥˜ê°„ì˜ ê´€ê³„)

- **[R] method calls another method**: ë©”ì„œë“œ ê°„ í˜¸ì¶œ
- **[R] table joins another table**: í…Œì´ë¸” ê°„ ì¡°ì¸
- **[R] class inherits another class**: í´ë˜ìŠ¤ ê°„ ìƒì†
- **[R] class implements another class**: í´ë˜ìŠ¤ ê°„ êµ¬í˜„

### ê´€ê³„ êµ¬í˜„ í˜„í™©

í˜„ì¬ êµ¬í˜„ëœ ê´€ê³„ ìˆ˜: **2,037ê°œ** (API_ENTRY ê´€ë ¨ ê´€ê³„ ì¶”ê°€ ì˜ˆì •)

- ì‹±ê¸€ë¼ì¸ (contain): 0ê°œ (í˜„ì¬ ë°ì´í„° ë¶€ì¡±)
- ë”ë¸”ë¼ì¸ (call, use): 825ê°œ
- ìƒí•˜ ë¶™ì–´ ìˆëŠ” ê²½ìš°: 1,212ê°œ
- API í˜¸ì¶œ ê´€ê³„: 0ê°œ (5ë‹¨ê³„ API ì§„ì…ì  ë¶„ì„ í›„ ì¶”ê°€ ì˜ˆì •)

### ìƒˆë¡œìš´ API ì»´í¬ë„ŒíŠ¸ í†µí•© ì„¤ê³„

**api_components í…Œì´ë¸”ì˜ íŠ¹ì§•:**

1. **í†µí•© ì„¤ê³„**: API_ENTRYì™€ FRONTEND_APIë¥¼ í•˜ë‚˜ì˜ í…Œì´ë¸”ë¡œ í†µí•©
2. **í•„ë“œ í†µí•©**: 
   - `tech_stack`: framework_type + technology_type í†µí•©
   - `interface_type`: return_type + call_method í†µí•©  
   - `metadata`: parameters + annotations í†µí•© (JSON)
3. **ìœ ì—°ì„±**: JSON metadataë¡œ í–¥í›„ í™•ì¥ ê°€ëŠ¥
4. **ì¼ê´€ì„±**: ê¸°ì¡´ components + relationships íŒ¨í„´ê³¼ ë™ì¼í•œ êµ¬ì¡°

### JSP â†’ API ê´€ê³„ ë¶„ì„ ì„¤ê³„

**JSPì—ì„œ API í˜¸ì¶œ íŒ¨í„´ ë¶„ì„:**

#### **1. JSP â†’ API ê´€ê³„ êµ¬ì¡°**
```mermaid
graph TD
    A[JSP íŒŒì¼] --> B[JSP ì»´í¬ë„ŒíŠ¸]
    B --> C[FRONTEND_API ì»´í¬ë„ŒíŠ¸]
    C --> D[API_ENTRY ì»´í¬ë„ŒíŠ¸]
    D --> E[METHOD ì»´í¬ë„ŒíŠ¸]
    E --> F[SQL_* ì»´í¬ë„ŒíŠ¸]
    F --> G[TABLE ì»´í¬ë„ŒíŠ¸]
    
    style A fill:#e1f5fe
    style C fill:#e8f5e8
    style D fill:#fff3e0
```

#### **2. JSP API í˜¸ì¶œ íŒ¨í„´**
- **JavaScript AJAX í˜¸ì¶œ**: `$.ajax()`, `fetch()`, `axios` ë“±
- **ì§ì ‘ í˜¸ì¶œ ê´€ê³„**: JSP â†’ FRONTEND_API (CALL_API_J2F)
- **ê°„ì ‘ í˜¸ì¶œ ê´€ê³„**: JSP â†’ FRONTEND_API â†’ API_ENTRY (CALL_API_J2F + CALL_API_F2B)

#### **3. ê´€ê³„ íƒ€ì… í™•ì¥**
```sql
-- JSP ê´€ë ¨ API í˜¸ì¶œ ê´€ê³„ë“¤
CALL_API_J2F    -- JSP â†’ FRONTEND_API
CALL_API_F2B    -- FRONTEND_API â†’ API_ENTRY  
CALL_API_BE     -- API_ENTRY â†’ METHOD
```

#### **4. ì™„ì „í•œ í˜¸ì¶œ ì²´ì¸**
```
JSP íŒŒì¼ â†’ JSP ì»´í¬ë„ŒíŠ¸ â†’ FRONTEND_API ì»´í¬ë„ŒíŠ¸ â†’ API_ENTRY ì»´í¬ë„ŒíŠ¸ â†’ METHOD ì»´í¬ë„ŒíŠ¸ â†’ SQL_* ì»´í¬ë„ŒíŠ¸ â†’ TABLE ì»´í¬ë„ŒíŠ¸
```

#### **5. JSP ë¶„ì„ ë¡œì§**
```python
def analyze_jsp_api_calls(self, jsp_content: str) -> List[APICall]:
    """JSPì—ì„œ API í˜¸ì¶œ ë¶„ì„"""
    # JavaScript AJAX í˜¸ì¶œ íŒ¨í„´ ë¶„ì„
    ajax_patterns = [
        r'\.ajax\s*\(\s*\{[^}]*url\s*:\s*[\'"]([^\'"]+)[\'"]',
        r'fetch\s*\(\s*[\'"]([^\'"]+)[\'"]',
        r'axios\.[get|post|put|delete]+\s*\(\s*[\'"]([^\'"]+)[\'"]'
    ]
    # íŒ¨í„´ ë§¤ì¹­ìœ¼ë¡œ API í˜¸ì¶œ ì¶”ì¶œ
```

#### **6. ê´€ê³„ ìƒì„± ë¡œì§**
1. **JSP ì»´í¬ë„ŒíŠ¸** â†’ **FRONTEND_API ì»´í¬ë„ŒíŠ¸** (CALL_API_J2F)
2. **FRONTEND_API ì»´í¬ë„ŒíŠ¸** â†’ **API_ENTRY ì»´í¬ë„ŒíŠ¸** (CALL_API_F2B)
3. **API_ENTRY ì»´í¬ë„ŒíŠ¸** â†’ **METHOD ì»´í¬ë„ŒíŠ¸** (CALL_API_BE)

### FRONTEND_API â†’ API_ENTRY 1:N ê´€ê³„ ì„¤ê³„

**í•˜ë‚˜ì˜ FRONTEND_APIê°€ ì—¬ëŸ¬ API_ENTRYë¥¼ í˜¸ì¶œí•˜ëŠ” 1:N ê´€ê³„:**

#### **1. 1:N ê´€ê³„ì˜ ì˜ë¯¸**
- **í•˜ë‚˜ì˜ FRONTEND_API**: í•˜ë‚˜ì˜ í”„ë¡ íŠ¸ì—”ë“œ í˜ì´ì§€/ì»´í¬ë„ŒíŠ¸
- **ì—¬ëŸ¬ API_ENTRY**: í•´ë‹¹ í˜ì´ì§€ì—ì„œ í˜¸ì¶œí•˜ëŠ” ì—¬ëŸ¬ ë°±ì—”ë“œ API

#### **2. ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ**
```javascript
// í•˜ë‚˜ì˜ React ì»´í¬ë„ŒíŠ¸ (FRONTEND_API)
const UserManagementPage = () => {
    // ì—¬ëŸ¬ API í˜¸ì¶œ
    const fetchUsers = () => fetch('/api/users/list');
    const fetchUserDetail = (id) => fetch(`/api/users/detail/${id}`);
    const deleteUser = (id) => fetch(`/api/users/delete/${id}`, {method: 'DELETE'});
    
    return &lt;div&gt;{/* í•˜ë‚˜ì˜ í˜ì´ì§€ì—ì„œ ì—¬ëŸ¬ API ì‚¬ìš© */}&lt;/div&gt;;
};
```

#### **3. ë°ì´í„°ë² ì´ìŠ¤ ê´€ê³„ êµ¬ì¡°**
```sql
-- í•˜ë‚˜ì˜ FRONTEND_API ì»´í¬ë„ŒíŠ¸
INSERT INTO components VALUES (
    1001, 1, NULL, 'UserManagementPage', 'FRONTEND_API', 
    NULL, 'FRONTEND', NULL, NULL, 'N', NULL, 'hash123', '2024-01-01', '2024-01-01', 'N'
);

-- ì—¬ëŸ¬ ê°œì˜ API_ENTRY ì»´í¬ë„ŒíŠ¸ë“¤
INSERT INTO components VALUES 
(1002, 1, 201, 'UserController', 'API_ENTRY', NULL, 'CONTROLLER', 25, 35, 'N', NULL, 'hash456', '2024-01-01', '2024-01-01', 'N'),
(1003, 1, 202, 'UserController', 'API_ENTRY', NULL, 'CONTROLLER', 40, 50, 'N', NULL, 'hash789', '2024-01-01', '2024-01-01', 'N'),
(1004, 1, 203, 'UserController', 'API_ENTRY', NULL, 'CONTROLLER', 55, 65, 'N', NULL, 'hash101', '2024-01-01', '2024-01-01', 'N');

-- 1:N ê´€ê³„ í…Œì´ë¸”
INSERT INTO relationships VALUES 
(1001, 1002, 'CALL_API_F2B', 0.95, 'N', NULL, 'hash_rel1', '2024-01-01', '2024-01-01', 'N'),  -- UserManagementPage â†’ getUserList
(1001, 1003, 'CALL_API_F2B', 0.95, 'N', NULL, 'hash_rel2', '2024-01-01', '2024-01-01', 'N'),  -- UserManagementPage â†’ getUserDetail  
(1001, 1004, 'CALL_API_F2B', 0.95, 'N', NULL, 'hash_rel3', '2024-01-01', '2024-01-01', 'N');  -- UserManagementPage â†’ deleteUser
```

#### **4. JSP í˜ì´ì§€ ì˜ˆì‹œ**
```jsp
<!-- í•˜ë‚˜ì˜ JSP í˜ì´ì§€ (FRONTEND_API) -->
<script>
// ì—¬ëŸ¬ API í˜¸ì¶œ
$.ajax({url: '/api/users/list', method: 'GET'});
$.ajax({url: '/api/users/detail', method: 'GET'});
$.ajax({url: '/api/users/delete', method: 'DELETE'});
</script>
```

#### **5. ê´€ê³„ êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨**

**5-1. 1:N ê´€ê³„ êµ¬ì¡° (FRONTEND_API â†’ API_ENTRY)**
```mermaid
graph TB
    A[UserManagementPage\nFRONTEND_API] --> B[getUserList\nAPI_ENTRY]
    A --> C[getUserDetail\nAPI_ENTRY]
    A --> D[deleteUser\nAPI_ENTRY]
    A --> E[getRoles\nAPI_ENTRY]
    
    style A fill:#e8f5e8
    style B fill:#fff3e0
    style C fill:#fff3e0
    style D fill:#fff3e0
    style E fill:#fff3e0
```

**5-2. API_ENTRY â†’ METHOD í˜¸ì¶œ ì²´ì¸**
```mermaid
graph TB
    B[getUserList\nAPI_ENTRY] --> F[UserService.getUsers\nMETHOD]
    C[getUserDetail\nAPI_ENTRY] --> G[UserService.getUser\nMETHOD]
    D[deleteUser\nAPI_ENTRY] --> H[UserService.deleteUser\nMETHOD]
    E[getRoles\nAPI_ENTRY] --> I[RoleService.getRoles\nMETHOD]
    
    style F fill:#e1f5fe
    style G fill:#e1f5fe
    style H fill:#e1f5fe
    style I fill:#e1f5fe
```

#### **6. 1:N ê´€ê³„ì˜ ì¥ì **
- **ì‹¤ì œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¡° ë°˜ì˜**: í•˜ë‚˜ì˜ í˜ì´ì§€ê°€ ì—¬ëŸ¬ APIë¥¼ í˜¸ì¶œí•˜ëŠ” ì¼ë°˜ì ì¸ íŒ¨í„´
- **ìœ ì—°í•œ í™•ì¥ì„±**: ìƒˆë¡œìš´ API ì¶”ê°€ ì‹œ ê¸°ì¡´ FRONTEND_APIì™€ ì‰½ê²Œ ì—°ê²°
- **ëª…í™•í•œ í˜¸ì¶œ ì²´ì¸**: í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë°±ì—”ë“œê¹Œì§€ì˜ ì™„ì „í•œ í˜¸ì¶œ ê²½ë¡œ ì¶”ì 
- **ì„±ëŠ¥ ë¶„ì„**: í•˜ë‚˜ì˜ í˜ì´ì§€ì—ì„œ í˜¸ì¶œí•˜ëŠ” ëª¨ë“  API ì„±ëŠ¥ ë¶„ì„ ê°€ëŠ¥

ì´ ìŠ¤í‚¤ë§ˆëŠ” SourceAnalyzer ì‹œìŠ¤í…œì˜ í•µì‹¬ ë°ì´í„° êµ¬ì¡°ë¥¼ ì •ì˜í•˜ë©°, í”„ë¡œì íŠ¸ ë¶„ì„ ê²°ê³¼ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì €ì¥í•˜ê³  ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

## SQL Content ë°ì´í„°ë² ì´ìŠ¤

### ê°œìš”

ì •ì œëœ SQL ë‚´ìš©ì„ gzip ì••ì¶•í•˜ì—¬ ì €ì¥í•˜ëŠ” ì „ìš© ë°ì´í„°ë² ì´ìŠ¤ì…ë‹ˆë‹¤. 3ë‹¨ê³„ XML íŒŒì‹± ê³¼ì •ì—ì„œ ì¶”ì¶œëœ ì •ì œëœ SQL ë‚´ìš©ì„ ì••ì¶•í•˜ì—¬ ì €ì¥í•˜ë©°, 2ì°¨ ê°œë°œ ë¦¬í¬íŠ¸ì—ì„œ í™œìš©ë©ë‹ˆë‹¤.

### ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

**ë°ì´í„°ë² ì´ìŠ¤ ê²½ë¡œ**: `./projects/{project_name}/SqlContent.db`

**ìƒì„± ìŠ¤í¬ë¦½íŠ¸**: `database/create_sql_content_db.sql`

### sql_contents í…Œì´ë¸”

ì •ì œëœ SQL ë‚´ìš©ì„ ì €ì¥í•˜ëŠ” í•µì‹¬ í…Œì´ë¸”ì…ë‹ˆë‹¤.

#### í…Œì´ë¸” êµ¬ì¡°

| ì»¬ëŸ¼ëª… | íƒ€ì… | ì œì•½ì¡°ê±´ | ì„¤ëª… |
|--------|------|----------|------|
| content_id | INTEGER | PRIMARY KEY AUTOINCREMENT | SQL ë‚´ìš© ê³ ìœ  ID |
| project_id | INTEGER | NOT NULL | í”„ë¡œì íŠ¸ ID (Foreign Key) |
| file_id | INTEGER | | XML íŒŒì¼ ID (Foreign Key) |
| component_id | INTEGER | | ì»´í¬ë„ŒíŠ¸ ID (Foreign Key) |
| component_name | VARCHAR(200) | | ì»´í¬ë„ŒíŠ¸ëª… |
| sql_content_compressed | BLOB | NOT NULL | gzip ì••ì¶•ëœ ì •ì œëœ SQL ë‚´ìš© |
| query_type | VARCHAR(20) | NOT NULL | ì¿¼ë¦¬ íƒ€ì… (SQL_SELECT, SQL_INSERT, SQL_UPDATE, SQL_DELETE, SQL_MERGE) |
| file_path | VARCHAR(500) | | íŒŒì¼ ê²½ë¡œ |
| file_name | VARCHAR(200) | | íŒŒì¼ëª… |
| line_start | INTEGER | | ì‹œì‘ ë¼ì¸ |
| line_end | INTEGER | | ì¢…ë£Œ ë¼ì¸ |
| hash_value | VARCHAR(64) | | SQL ë‚´ìš© í•´ì‹œê°’ |
| error_message | TEXT | | ì˜¤ë¥˜ ë©”ì‹œì§€ |
| created_at | DATETIME | DEFAULT CURRENT_TIMESTAMP | ìƒì„±ì¼ì‹œ |
| updated_at | DATETIME | DEFAULT CURRENT_TIMESTAMP | ìˆ˜ì •ì¼ì‹œ |
| del_yn | CHAR(1) | DEFAULT 'N' | ì‚­ì œ ì—¬ë¶€ |

#### ì¸ë±ìŠ¤

- `ix_sql_contents_01`: (project_id, created_at) - í”„ë¡œì íŠ¸ë³„ ì‹œê°„ìˆœ ì¡°íšŒ
- `ix_sql_contents_02`: (query_type, created_at) - ì¿¼ë¦¬ íƒ€ì…ë³„ ì‹œê°„ìˆœ ì¡°íšŒ
- `ix_sql_contents_03`: (file_path, created_at) - íŒŒì¼ë³„ ì‹œê°„ìˆœ ì¡°íšŒ
- `ix_sql_contents_04`: (component_name, created_at) - ì»´í¬ë„ŒíŠ¸ë³„ ì‹œê°„ìˆœ ì¡°íšŒ
- `ix_sql_contents_05`: (hash_value) - í•´ì‹œê°’ìœ¼ë¡œ ì¤‘ë³µ ê²€ì‚¬

### íŠ¹ì§•

1. **ì••ì¶• ì €ì¥**: gzip ì••ì¶•ì„ ì‚¬ìš©í•˜ì—¬ ì €ì¥ ê³µê°„ ìµœì í™”
2. **í”„ë¡œì íŠ¸ë³„ ë…ë¦½**: ê° í”„ë¡œì íŠ¸ë§ˆë‹¤ ë³„ë„ì˜ SqlContent.db íŒŒì¼ ìƒì„±
3. **ë©”íƒ€ë°ì´í„° ì—°ê²°**: components í…Œì´ë¸”ê³¼ ì—°ê²°í•˜ì—¬ ìƒì„¸ ì •ë³´ ì œê³µ
4. **2ì°¨ ê°œë°œ í™œìš©**: ë¦¬í¬íŠ¸ ìƒì„± ì‹œ ì •ì œëœ SQL ë‚´ìš© í™œìš©

### í™œìš© ì˜ˆì‹œ

```python
# SQL Content Manager ì‚¬ìš© ì˜ˆì‹œ
from util.sql_content_manager import SqlContentManager

# ì´ˆê¸°í™”
sql_content_manager = SqlContentManager("sampleSrc")

# SQL ë‚´ìš© ì €ì¥
sql_content_manager.save_sql_content(
    sql_content="SELECT * FROM users WHERE id = ?",
    project_id=1,
    file_id=100,
    query_type="SQL_SELECT",
    file_path="/src/main/resources/mapper/UserMapper.xml",
    component_name="SQL_CONTENT_SELECT",
    file_name="UserMapper.xml",
    line_start=10,
    line_end=15,
    hash_value="a1b2c3d4e5f6..."
)

# í†µê³„ ì¡°íšŒ
stats = sql_content_manager.get_stats(1)
print(f"ì €ì¥ëœ SQL ë‚´ìš©: {stats['total_stats'][0]}ê°œ")
print(f"ì´ ì••ì¶• í¬ê¸°: {stats['total_stats'][1]} bytes")

# ì—°ê²° í•´ì œ
sql_content_manager.close()
```

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- **[ìš”êµ¬ì‚¬í•­ì •ì˜ì„œ.md](./ìš”êµ¬ì‚¬í•­ì •ì˜ì„œ.md)**: ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ë° ê¸°ëŠ¥ ëª…ì„¸
- **[ì²˜ë¦¬í”Œë¡œìš°.md](./ì²˜ë¦¬í”Œë¡œìš°.md)**: ì‹¤ì œ êµ¬í˜„ ê³¼ì • ë° ê°œë°œ ê°€ì´ë“œ
- **[ì²˜ë¦¬í”Œë¡œìš°_ìƒì„¸_3ë‹¨ê³„.md](./ì²˜ë¦¬í”Œë¡œìš°_ìƒì„¸_3ë‹¨ê³„.md)**: 3ë‹¨ê³„ XML íŒŒì‹± ìƒì„¸ ì²˜ë¦¬ ê³¼ì •
- **[create_table_script.sql](../database/create_table_script.sql)**: ë©”íƒ€ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜ ì›ë³¸ íŒŒì¼
- **[create_sql_content_db.sql](../database/create_sql_content_db.sql)**: SQL Content ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜ íŒŒì¼