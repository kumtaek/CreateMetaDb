# 메타디비 대사비교보고서 - 연관관계 도출 중심

## 개요
메타디비 예상데이터(정답지)와 실제 생성된 메타디비 데이터를 비교 분석하여 **연관관계 도출과 조인관계 도출**에 필요한 핵심 정보의 차이점을 검증한 보고서입니다.

**분석 일시**: 2025-01-23 15:30:00  
**분석 대상**: SampleSrc 프로젝트  
**비교 기준**: `docs/메타디비예상데이터.md` (연관관계 도출 중심 정답지)  
**실제 데이터**: `projects/SampleSrc/metadata.db`

## 1. 전체 데이터 건수 비교

### 1.1 테이블별 데이터 건수 비교

| 테이블명 | 예상 건수 | 실제 건수 | 차이 | 정확도 | 상태 |
|----------|-----------|-----------|------|--------|------|
| **projects** | 1 | 1 | 0 | 100% | ✅ 정확 |
| **files** | 148 | 141 | -7 | 95.3% | ⚠️ 부분 누락 |
| **classes** | 38 | 0 | -38 | 0% | ❌ 완전 누락 |
| **components** | 1,500 | 531 | -969 | 35.4% | ❌ 심각한 부족 |
| **tables** | 25 | 37 | +12 | 148% | ⚠️ 과다 생성 |
| **columns** | 140 | 52 | -88 | 37.1% | ❌ 부족 |
| **relationships** | 1,200 | 330 | -870 | 27.5% | ❌ 심각한 부족 |

### 1.2 전체 정확도 분석
- **전체 데이터 건수**: 예상 2,952건 → 실제 1,092건 (37.0% 정확도)
- **주요 문제점**: classes 테이블이 완전히 누락됨
- **과다 생성**: tables 테이블이 예상보다 48% 더 많이 생성됨

## 2. 연관관계 도출 핵심 분석

### 2.1 컴포넌트 타입별 분석 (연관관계 도출 중심)

| 컴포넌트 타입 | 예상 건수 | 실제 건수 | 차이 | 정확도 | 연관관계 도출 영향 |
|---------------|-----------|-----------|------|--------|-------------------|
| **API_URL** | 100 | 248 | +148 | 248% | ⚠️ 과다 생성 (성능 영향) |
| **SQL_SELECT** | 80 | 140 | +60 | 175% | ⚠️ 과다 생성 (정확도 저하) |
| **TABLE** | 25 | 53 | +28 | 212% | ⚠️ 과다 생성 (중복 테이블) |
| **COLUMN** | 140 | 37 | -103 | 26.4% | ❌ 심각한 부족 (ERD 불완전) |
| **SQL_INSERT** | 20 | 19 | -1 | 95% | ✅ 거의 정확 |
| **SQL_UPDATE** | 25 | 14 | -11 | 56% | ❌ 부족 |
| **SQL_DELETE** | 10 | 4 | -6 | 40% | ❌ 부족 |
| **SQL_MERGE** | 10 | 4 | -6 | 40% | ❌ 부족 |
| **SQL_SELECT_DYNAMIC** | 45 | 0 | -45 | 0% | ❌ 완전 누락 |
| **SQL_INSERT_DYNAMIC** | 3 | 0 | -3 | 0% | ❌ 완전 누락 |
| **SQL_UPDATE_DYNAMIC** | 15 | 0 | -15 | 0% | ❌ 완전 누락 |
| **SQL_DELETE_DYNAMIC** | 4 | 0 | -4 | 0% | ❌ 완전 누락 |

### 2.2 관계 타입별 분석 (연관관계 도출 핵심)

| 관계 타입 | 예상 건수 | 실제 건수 | 차이 | 정확도 | 연관관계 도출 영향 |
|-----------|-----------|-----------|------|--------|-------------------|
| **USE_TABLE** | 400 | 273 | -127 | 68.3% | ⚠️ 부족 (SQL→TABLE 관계) |
| **JOIN_EXPLICIT** | 30 | 25 | -5 | 83.3% | ⚠️ 부분 부족 (조인 관계) |
| **JOIN_IMPLICIT** | 20 | 19 | -1 | 95% | ✅ 거의 정확 |
| **CALL_METHOD** | 500 | 13 | -487 | 2.6% | ❌ 심각한 부족 (호출 체인) |
| **CALL_QUERY** | 300 | 0 | -300 | 0% | ❌ 완전 누락 (DAO→SQL) |
| **INHERITANCE** | 70 | 0 | -70 | 0% | ❌ 완전 누락 (상속 관계) |

## 3. 연관관계 도출 핵심 문제점 분석

### 3.1 Classes 테이블 완전 누락 (0% 정확도)
**원인 분석**:
- Java 파서에서 클래스 정보 추출 실패
- 상속 관계 분석 로직 미구현
- AST 분석에서 클래스 정의 파싱 오류

**연관관계 도출 영향**: 매우 높음
- **Controller → Service → DAO** 호출 체인 분석 불가
- **상속 관계** 분석 불가
- **클래스별 메서드 그룹핑** 불가

### 3.2 SQL_DYNAMIC 컴포넌트 완전 누락 (0% 정확도)
**원인 분석**:
- 다이나믹 쿼리 분석 로직 미구현
- MyBatis XML의 `<if>`, `<choose>` 태그 분석 실패
- Java 문자열 연결 쿼리 분석 미지원
- JPA @Query 다이나믹 쿼리 분석 미지원

**연관관계 도출 영향**: 높음
- **복잡한 쿼리 분석** 불가
- **조건부 테이블 사용 관계** 분석 불가
- **다이나믹 조인 관계** 분석 불가

### 3.3 CALL_METHOD 관계 심각한 부족 (2.6% 정확도)
**원인 분석**:
- 메서드 호출 관계 분석 로직 미구현
- AST에서 메서드 호출 추적 실패
- Controller → Service → DAO 호출 체인 분석 불가

**연관관계 도출 영향**: 매우 높음
- **API_URL → METHOD → SQL** 호출 체인 분석 불가
- **비즈니스 로직 흐름** 추적 불가
- **콜 체인 리포트** 생성 불가

### 3.4 CALL_QUERY 관계 완전 누락 (0% 정확도)
**원인 분석**:
- DAO → SQL 호출 관계 분석 로직 미구현
- MyBatis 매퍼 연결 분석 실패
- JPA Repository → @Query 연결 분석 실패

**연관관계 도출 영향**: 매우 높음
- **DAO → SQL** 호출 관계 분석 불가
- **메서드별 SQL 매핑** 분석 불가

## 4. 조인관계 도출 분석

### 4.1 조인 관계 현황
- **JOIN_EXPLICIT**: 25개 (예상 30개 대비 83.3% 정확도)
- **JOIN_IMPLICIT**: 19개 (예상 20개 대비 95% 정확도)
- **총 조인 관계**: 44개 (예상 50개 대비 88% 정확도)

### 4.2 조인관계 도출 문제점
1. **명시적 조인 부족**: JOIN_EXPLICIT이 5개 부족
2. **암시적 조인 분석 부족**: WHERE 절의 조인 조건 분석 미흡
3. **다이나믹 조인 누락**: SQL_DYNAMIC 컴포넌트의 조인 관계 분석 불가

## 5. 파일 타입별 분석

### 5.1 파일 타입 분포 비교

| 파일 타입 | 예상 건수 | 실제 건수 | 차이 | 정확도 |
|-----------|-----------|-----------|------|--------|
| **JAVA** | 91 | 91 | 0 | 100% |
| **XML** | 14 | 20 | +6 | 142.9% |
| **JSP** | 9 | 12 | +3 | 133.3% |
| **JSX** | 6 | 6 | 0 | 100% |
| **TSX** | 2 | 2 | 0 | 100% |
| **TS** | 2 | 2 | 0 | 100% |
| **VUE** | 4 | 4 | 0 | 100% |
| **JS** | 1 | 1 | 0 | 100% |
| **CSV** | 2 | 2 | 0 | 100% |
| **PROPERTIES** | 1 | 1 | 0 | 100% |

### 5.2 파일 분석 결과
- **정확도**: 95.3% (141/148)
- **차이점**: XML 파일이 6개 더 많이 인식됨 (web.xml, persistence.xml 등 추가 인식)
- **누락**: 7개 파일이 누락됨 (주로 프론트엔드 파일들)

## 6. 연관관계 도출 시스템 정확도 평가

### 6.1 전체 정확도
- **데이터 건수 정확도**: 37.0%
- **파일 인식 정확도**: 95.3%
- **컴포넌트 분석 정확도**: 35.4%
- **관계 분석 정확도**: 27.5%

### 6.2 연관관계 도출 기능별 정확도
- **파일 스캔**: 95.3% (양호)
- **클래스 분석**: 0% (심각)
- **메서드 분석**: 2.6% (심각)
- **SQL 분석**: 40-175% (불균형)
- **관계 분석**: 27.5% (부족)
- **조인관계 분석**: 88% (양호)

## 7. 개선 권장사항 (연관관계 도출 중심)

### 7.1 우선순위 1 (Critical) - 연관관계 도출 핵심
1. **클래스 분석 로직 구현**
   - Java AST에서 클래스 정의 추출
   - 상속 관계 분석 구현
   - 클래스 메타데이터 수집

2. **메서드 호출 관계 분석 구현**
   - AST에서 메서드 호출 추적
   - Controller → Service → DAO 호출 체인 분석
   - 메서드 시그니처 매칭

3. **DAO → SQL 호출 관계 분석 구현**
   - MyBatis 매퍼 연결 분석
   - JPA Repository → @Query 연결 분석
   - CALL_QUERY 관계 도출

### 7.2 우선순위 2 (High) - 조인관계 도출
1. **다이나믹 쿼리 분석 구현**
   - MyBatis XML 다이나믹 태그 분석
   - Java 문자열 연결 쿼리 분석
   - JPA @Query 다이나믹 쿼리 분석

2. **조인 관계 분석 개선**
   - 명시적 조인 분석 정확도 향상
   - 암시적 조인 분석 로직 개선
   - 다이나믹 조인 관계 분석

### 7.3 우선순위 3 (Medium) - 데이터 품질
1. **API URL 중복 제거**
   - URL 필터링 로직 구현
   - 중복 제거 알고리즘 적용

2. **SQL 분석 정확도 향상**
   - SQL 타입별 분석 로직 개선
   - 쿼리 복잡도 분석 추가

## 8. 결론 - 연관관계 도출 관점

### 8.1 현재 상태
- **파일 스캔**: 양호한 수준 (95.3% 정확도)
- **아키텍처 분석**: 심각한 수준 (클래스, 메서드 관계 분석 실패)
- **SQL 분석**: 불균형 (일부 과다, 일부 부족)
- **조인관계 분석**: 양호한 수준 (88% 정확도)
- **전체 시스템**: 부분적 동작 (37% 정확도)

### 8.2 연관관계 도출 핵심 문제점
1. **클래스 분석 완전 실패**: 아키텍처 분석 불가
2. **메서드 관계 분석 실패**: 콜 체인 분석 불가
3. **다이나믹 쿼리 분석 미지원**: 복잡한 쿼리 분석 불가
4. **DAO → SQL 관계 분석 실패**: 메서드별 SQL 매핑 불가

### 8.3 개선 필요성
현재 시스템은 파일 스캔과 기본적인 SQL 분석만 가능한 수준으로, **연관관계 도출의 핵심 기능**인 아키텍처 분석과 관계 추적이 거의 불가능한 상태입니다.

**즉시 개선이 필요한 영역**:
- Java 클래스 분석 로직
- 메서드 호출 관계 분석
- 상속 관계 분석
- 다이나믹 쿼리 분석
- DAO → SQL 호출 관계 분석

이러한 개선을 통해 메타디비의 **연관관계 도출 정확도**를 37%에서 80% 이상으로 향상시킬 수 있을 것으로 예상됩니다.