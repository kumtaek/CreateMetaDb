로깅 설정 파일 로드 실패: cannot import name 'PathUtils' from 'util' (consider renaming 'D:\\Analyzer\\CreateMetaDb\\util\\__init__.py' if it has the same name as a library you intended to import)
2025-09-14 21:39:17,229 - SourceAnalyzer - INFO - main.py:17 - Recursion limit set to: 50
2025-09-14 21:39:17,230 - SourceAnalyzer - INFO - main.py:25 - 오래된 로그 파일 정리 시작
2025-09-14 21:39:17,230 - SourceAnalyzer - INFO - file_utils.py:362 - 삭제할 오래된 로그 파일이 없습니다
2025-09-14 21:39:17,230 - SourceAnalyzer - INFO - main.py:30 - 삭제할 오래된 로그 파일이 없습니다
2025-09-14 21:39:17,230 - SourceAnalyzer - INFO - main.py:33 - SourceAnalyzer 시작
2025-09-14 21:39:17,239 - SourceAnalyzer - INFO - main.py:44 - 분석 대상 프로젝트: sampleSrc
2025-09-14 21:39:17,240 - SourceAnalyzer - INFO - main.py:61 - 분석 옵션:
2025-09-14 21:39:17,240 - SourceAnalyzer - INFO - main.py:62 -   - 메타데이터베이스 초기화: False
2025-09-14 21:39:17,240 - SourceAnalyzer - INFO - main.py:63 -   - 상세 로그: False
2025-09-14 21:39:17,240 - SourceAnalyzer - INFO - main.py:64 -   - 출력 형식: html
2025-09-14 21:39:17,240 - SourceAnalyzer - INFO - main.py:65 -   - 드라이런 모드: False
2025-09-14 21:39:17,240 - SourceAnalyzer - INFO - main.py:66 -   - 강제 실행: False
2025-09-14 21:39:17,240 - SourceAnalyzer - INFO - main.py:75 - 1단계 실행: 파일 정보 저장 (프로젝트 전체 스캔)
2025-09-14 21:39:17,241 - SourceAnalyzer - INFO - file_loading.py:1138 - === 파일 스캔 시작: 파일 정보 저장 ===
2025-09-14 21:39:17,248 - SourceAnalyzer - INFO - file_loading.py:86 - 메타데이터베이스 초기화 완료: D:\Analyzer\CreateMetaDb\projects\sampleSrc\metadata.db
2025-09-14 21:39:17,248 - SourceAnalyzer - INFO - file_loading.py:144 - 프로젝트 파일 스캔 시작: D:\Analyzer\CreateMetaDb\projects\sampleSrc
2025-09-14 21:39:17,603 - SourceAnalyzer - INFO - file_loading.py:185 - 파일 스캔 완료: 총 47개 파일
2025-09-14 21:39:17,609 - SourceAnalyzer - INFO - file_loading.py:474 - 파일 정보 저장 완료: 47개 파일
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1226 - === 파일 스캔 통계 ===
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1227 - 총 파일 수: 47
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1228 - 성공 스캔: 47
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1229 - 오류 파일: 0
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1230 - Java 파일: 30
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1231 - XML 파일: 6
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1232 - JSP 파일: 9
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1233 - SQL 파일: 0
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1234 - CSV 파일: 2
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1235 - 기타 파일: 0
2025-09-14 21:39:17,610 - SourceAnalyzer - INFO - file_loading.py:1161 - === 파일 스캔 완료 ===
2025-09-14 21:39:17,616 - SourceAnalyzer - INFO - main.py:89 - 1단계 완료: 파일 정보 저장
2025-09-14 21:39:17,621 - SourceAnalyzer - INFO - main.py:108 - 전역 프로젝트 정보 설정: sampleSrc (ID: 1)
2025-09-14 21:39:17,621 - SourceAnalyzer - INFO - main.py:118 - 2단계 실행: 데이터베이스 구조 저장 및 컴포넌트 생성
2025-09-14 21:39:17,621 - SourceAnalyzer - INFO - file_loading.py:1181 - === 데이터베이스 로딩 시작: 데이터베이스 구조 저장 ===
2025-09-14 21:39:17,623 - SourceAnalyzer - INFO - file_utils.py:55 - 인코딩 문제 감지, 다른 인코딩으로 재시도: ALL_TABLES.csv
2025-09-14 21:39:17,623 - SourceAnalyzer - INFO - file_loading.py:547 - CSV 파일 로드 완료: D:\Analyzer\CreateMetaDb\projects\sampleSrc\db_schema\ALL_TABLES.csv, 16개 행
2025-09-14 21:39:17,625 - SourceAnalyzer - INFO - file_loading.py:644 - 테이블 정보 저장 완료: 16개 테이블 (오류: 0개)
2025-09-14 21:39:17,626 - SourceAnalyzer - INFO - file_utils.py:55 - 인코딩 문제 감지, 다른 인코딩으로 재시도: ALL_TAB_COLUMNS.csv
2025-09-14 21:39:17,627 - SourceAnalyzer - INFO - file_loading.py:547 - CSV 파일 로드 완료: D:\Analyzer\CreateMetaDb\projects\sampleSrc\db_schema\ALL_TAB_COLUMNS.csv, 91개 행
2025-09-14 21:39:17,629 - SourceAnalyzer - INFO - file_loading.py:762 - 컬럼 정보 저장 완료: 91개 컬럼 (오류: 0개)
2025-09-14 21:39:17,630 - SourceAnalyzer - INFO - file_loading.py:829 - 테이블 컴포넌트 생성 완료: 16개
2025-09-14 21:39:17,632 - SourceAnalyzer - INFO - file_loading.py:909 - 컬럼 컴포넌트 생성 완료: 91개
2025-09-14 21:39:17,638 - SourceAnalyzer - INFO - file_loading.py:967 - 컬럼 component_id 업데이트 완료: 91개
2025-09-14 21:39:17,638 - SourceAnalyzer - INFO - file_loading.py:1239 - === 데이터베이스 구조 저장 통계 ===
2025-09-14 21:39:17,639 - SourceAnalyzer - INFO - file_loading.py:1240 - 테이블 로드: 16 (오류: 0)
2025-09-14 21:39:17,639 - SourceAnalyzer - INFO - file_loading.py:1241 - 컬럼 로드: 91 (오류: 0)
2025-09-14 21:39:17,639 - SourceAnalyzer - INFO - file_loading.py:1242 - 컴포넌트 생성: 107 (오류: 0)
2025-09-14 21:39:17,639 - SourceAnalyzer - INFO - file_loading.py:1243 - inferred 컬럼 생성: 0
2025-09-14 21:39:17,639 - SourceAnalyzer - INFO - file_loading.py:1252 - 오류 없이 완료
2025-09-14 21:39:17,639 - SourceAnalyzer - INFO - file_loading.py:1212 - === 데이터베이스 로딩 완료 ===
2025-09-14 21:39:17,639 - SourceAnalyzer - INFO - main.py:125 - 2단계 완료: 데이터베이스 구조 저장 및 컴포넌트 생성
2025-09-14 21:39:17,639 - SourceAnalyzer - INFO - main.py:131 - 3단계 실행: XML 파일 분석 및 SQL 컴포넌트 등록 + JOIN 관계 분석
2025-09-14 21:39:17,699 - SourceAnalyzer - INFO - sql_content_manager.py:63 - SQL Content 데이터베이스 초기화 완료: D:\Analyzer\CreateMetaDb\projects\sampleSrc\SqlContent.db
2025-09-14 21:39:17,699 - SourceAnalyzer - INFO - xml_loading.py:70 - === XML 로딩 시작: 3~4단계 통합 처리 ===
2025-09-14 21:39:17,705 - SourceAnalyzer - INFO - xml_parser.py:148 - MyBatis XML 파일 수집 완료: 6개
2025-09-14 21:39:17,730 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: columns, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,731 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,734 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: tables, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,734 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,735 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: columns, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,736 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,742 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: columns, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,744 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,749 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: tables, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,749 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,750 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: columns, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,751 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,753 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: columns, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,755 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,758 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: tables, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,759 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,759 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: columns, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,760 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,766 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: columns, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,766 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,768 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: tables, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,768 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,768 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: columns, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,769 - SourceAnalyzer - ERROR - database_utils.py:424 - UPSERT 실패: components, 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,774 - SourceAnalyzer - INFO - xml_loading.py:171 - === XML 로딩 엔진: SQL 컴포넌트 저장 시작 ===
2025-09-14 21:39:17,774 - SourceAnalyzer - INFO - xml_loading.py:172 - 전달받은 SQL 쿼리 수: 8개
2025-09-14 21:39:17,774 - SourceAnalyzer - INFO - xml_loading.py:180 - XML에서 추출된 SQL 쿼리 타입별 통계: {'select': 8}
2025-09-14 21:39:17,774 - SourceAnalyzer - INFO - xml_loading.py:193 - 프로젝트 ID: 1
2025-09-14 21:39:17,774 - SourceAnalyzer - INFO - xml_loading.py:275 - inferred 테이블 생성 시도: DEPARTMENTS
2025-09-14 21:39:17,775 - SourceAnalyzer - INFO - xml_loading.py:448 - inferred 테이블용 file_id 찾음: 6
2025-09-14 21:39:17,775 - SourceAnalyzer - INFO - xml_loading.py:498 - components 테이블에 데이터 삽입 시도: {'project_id': 1, 'component_type': 'TABLE', 'component_name': 'DEPARTMENTS', 'parent_id': None, 'file_id': 6, 'layer': 'DATA', 'line_start': None, 'line_end': None, 'hash_value': 'INFERRED', 'has_error': 'N', 'error_message': None, 'del_yn': 'N'}
2025-09-14 21:39:17,775 - SourceAnalyzer - INFO - xml_loading.py:500 - components 테이블 삽입 결과: 108
2025-09-14 21:39:17,775 - SourceAnalyzer - INFO - xml_loading.py:521 - tables 테이블에 데이터 삽입 시도: {'project_id': 1, 'component_id': 108, 'table_name': 'DEPARTMENTS', 'table_owner': 'UNKNOWN', 'table_comments': 'Inferred from SQL analysis', 'has_error': 'N', 'error_message': None, 'hash_value': 'INFERRED', 'del_yn': 'N'}
2025-09-14 21:39:17,775 - SourceAnalyzer - ERROR - database_utils.py:143 - 데이터베이스 연결 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
2025-09-14 21:39:17,779 - SourceAnalyzer - ERROR - logger.py:207 - FATAL ERROR at D:\Analyzer\CreateMetaDb\util\database_utils.py:602 in insert_or_replace_with_id()
Code: return self.upsert(table_name, data)
Message: 데이터베이스 연결 오류: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
Exception: TypeError: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'
Stack Trace:
Traceback (most recent call last):
  File "D:\Analyzer\CreateMetaDb\util\database_utils.py", line 141, in get_connection
    yield conn
  File "D:\Analyzer\CreateMetaDb\util\database_utils.py", line 602, in insert_or_replace_with_id
    return self.upsert(table_name, data)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
TypeError: DatabaseUtils.upsert() missing 1 required positional argument: 'unique_columns'

2025-09-14 21:39:17,779 - SourceAnalyzer - ERROR - logger.py:210 - 
[FATAL ERROR] 프로그램이 에러로 인해 종료됩니다. (종료코드: 1)
2025-09-14 21:39:17,779 - SourceAnalyzer - ERROR - logger.py:211 - 자세한 내용은 로그 파일을 확인하세요: logs/SourceAnalyzer_20250914_213917.log
2025-09-14 21:39:17,782 - SourceAnalyzer - INFO - sql_content_manager.py:282 - SQL Content 데이터베이스 연결 해제
